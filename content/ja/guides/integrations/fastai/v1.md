---
title: fastai v1
menu:
  default:
    identifier: ja-guides-integrations-fastai-v1
    parent: fastai
---

{{% alert %}}
このドキュメントは fastai v1 用です。  
現在の fastai バージョンを利用している場合は、[fastai のページ]({{< relref path="../" lang="ja" >}}) を参照してください。
{{% /alert %}}

fastai v1 を使ったスクリプト向けに、モデルのトポロジー、ロス、メトリクス、重み、勾配、サンプル予測、ベストな訓練済みモデルを自動でログできるコールバックを用意しています。

```python
import wandb
from wandb.fastai import WandbCallback

wandb.init()

learn = cnn_learner(data, model, callback_fns=WandbCallback)
learn.fit(epochs)
```

ログするデータはコールバックのコンストラクタで設定が可能です。

```python
from functools import partial

learn = cnn_learner(
    data, model, callback_fns=partial(WandbCallback, input_type="images")
)
```

また、トレーニング開始時のみ WandbCallback を使うこともできます。この場合はインスタンス化が必要です。

```python
learn.fit(epochs, callbacks=WandbCallback(learn))
```

このタイミングでカスタムパラメータも指定できます。

```python
learn.fit(epochs, callbacks=WandbCallback(learn, input_type="images"))
```

## サンプルコード

インテグレーションの動作を確認できる例をいくつかご用意しています：

**Fastai v1**

* [Classify Simpsons characters](https://github.com/borisdayma/simpsons-fastai)[: ](https://app.wandb.ai/jxmorris12/huggingface-demo/reports/A-Step-by-Step-Guide-to-Tracking-Hugging-Face-Model-Performance--VmlldzoxMDE2MTU)Fastai モデルのトラッキングと比較ができるシンプルなデモ
* [Semantic Segmentation with Fastai](https://github.com/borisdayma/semantic-segmentation): 自動運転車向けニューラルネットワークの最適化

## オプション

`WandbCallback()` クラスは複数のオプションに対応しています：

| キーワード引数      | デフォルト | 説明                                                                                                 |
| ------------------- | ---------- | ---------------------------------------------------------------------------------------------------- |
| learn               | N/A        | フックする fast.ai learner インスタンス。                                                            |
| save_model          | True       | モデルがステップごとに改善された場合に保存。トレーニング終了時には最良モデルをロードします。             |
| mode                | auto       | `min`、`max`、または `auto`：`monitor` で指定したトレーニングメトリクスの比較方法。                   |
| monitor             | None       | ベストモデル保存用のトレーニングメトリクス。None の場合は検証ロスがデフォルト。                        |
| log                 | gradients  | `gradients`、`parameters`、`all`、または None。ロスとメトリクスは常にログされます。                    |
| input_type          | None       | `images` または `None`。サンプル予測の表示に利用。                                                     |
| validation_data     | None       | `input_type` が設定されている場合にサンプル予測で使われるデータ。                                       |
| predictions         | 36         | `input_type` 設定かつ `validation_data` が None の場合のサンプル予測数。                              |
| seed                | 12345      | `input_type` 設定かつ `validation_data` が None の場合のサンプル予測用乱数シード。                     |