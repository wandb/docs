---
title: fastai v1
menu:
  default:
    identifier: ja-guides-integrations-fastai-v1
    parent: fastai
---

{{% alert %}}
このドキュメントは fastai v1 向けです。
現在の fastai を使用している場合は、[fastai のページ]({{< relref path="../" lang="ja" >}}) を参照してください。
{{% /alert %}}

fastai v1 を利用する スクリプト 向けに、モデル のトポロジ、損失、メトリクス、重み、勾配、サンプル 予測、そして最良の学習済み モデル を自動で ログ する コールバック を提供しています。

```python
import wandb
from wandb.fastai import WandbCallback

wandb.init()

learn = cnn_learner(data, model, callback_fns=WandbCallback)
learn.fit(epochs)
```

どの データ を ログ するかは、コールバックのコンストラクタで設定できます。

```python
from functools import partial

learn = cnn_learner(
    data, model, callback_fns=partial(WandbCallback, input_type="images")
)
```

トレーニング 開始時だけ WandbCallback を使うこともできます。その場合はインスタンス化する必要があります。

```python
learn.fit(epochs, callbacks=WandbCallback(learn))
```

その段階でカスタム パラメータを渡すこともできます。

```python
learn.fit(epochs, callbacks=WandbCallback(learn, input_type="images"))
```

## サンプルコード

インテグレーションがどのように動作するか分かるよう、いくつかの例を用意しました。

**fastai v1**

* [シンプソンズのキャラクターを分類](https://github.com/borisdayma/simpsons-fastai)[: ](https://app.wandb.ai/jxmorris12/huggingface-demo/reports/A-Step-by-Step-Guide-to-Tracking-Hugging-Face-Model-Performance--VmlldzoxMDE2MTU)fastai の モデル を追跡して比較するシンプルな デモ
* [fastai での セマンティックセグメンテーション](https://github.com/borisdayma/semantic-segmentation): 自動運転向けの ニューラルネットワーク を最適化

## オプション

`WandbCallback()` クラスは複数のオプションをサポートします:

| キーワード引数       | デフォルト | 説明 |
| ---------------- | --------- | ---- |
| learn            | N/A       | フックする fastai の Learner。 |
| save_model       | True      | 各ステップで改善があれば モデル を保存します。トレーニング の最後に最良の モデル も読み込みます。 |
| mode             | auto      | `min`、`max`、または `auto`。ステップ間で `monitor` に指定した トレーニング メトリクス をどのように比較するか。 |
| monitor          | None      | 最良の モデル を保存するための性能指標となる トレーニング メトリクス。None の場合は検証損失がデフォルト。 |
| log              | gradients | `gradients`、`parameters`、`all`、または None。損失とメトリクスは常に ログ されます。 |
| input_type       | None      | `images` または `None`。サンプル 予測を表示するために使用します。 |
| validation_data  | None      | `input_type` が設定されている場合のサンプル 予測に使用する データ。 |
| predictions      | 36        | `input_type` が設定され、`validation_data` が `None` の場合に作成する 予測 の数。 |
| seed             | 12345     | `input_type` が設定され、`validation_data` が `None` の場合に、サンプル 予測用の乱数生成器を初期化します。 |