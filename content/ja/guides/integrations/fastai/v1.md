---
title: fastai v1
menu:
  default:
    identifier: v1
    parent: fastai
---

{{% alert %}}
このドキュメントは fastai v1 用です。  
現在の fastai バージョンを使用している場合は、[fastai のページ]({{< relref "../" >}}) をご覧ください。
{{% /alert %}}

fastai v1 を使ったスクリプトでは、モデルのトポロジーや損失、メトリクス、重み、勾配、サンプル予測、ベストなトレーニング済みモデルを自動でログするコールバックを用意しています。

```python
import wandb
from wandb.fastai import WandbCallback

wandb.init()

learn = cnn_learner(data, model, callback_fns=WandbCallback)
learn.fit(epochs)
```

ログするデータはコールバックのコンストラクタで設定可能です。

```python
from functools import partial

learn = cnn_learner(
    data, model, callback_fns=partial(WandbCallback, input_type="images")
)
```

WandbCallback は、トレーニング開始時のみ利用することもできます。その場合はインスタンス化が必要です。

```python
learn.fit(epochs, callbacks=WandbCallback(learn))
```

このタイミングでカスタムパラメータも指定できます。

```python
learn.fit(epochs, callbacks=WandbCallback(learn, input_type="images"))
```

## サンプルコード

インテグレーションの動作を確認できるサンプルをいくつか用意しています：

**Fastai v1**

* [Simpsons キャラクターを分類する](https://github.com/borisdayma/simpsons-fastai)[: ](https://app.wandb.ai/jxmorris12/huggingface-demo/reports/A-Step-by-Step-Guide-to-Tracking-Hugging-Face-Model-Performance--VmlldzoxMDE2MTU) Fastai モデルのトラッキングと比較のためのシンプルなデモ
* [Fastai によるセマンティックセグメンテーション](https://github.com/borisdayma/semantic-segmentation)：自動運転車向けニューラルネットワークの最適化

## オプション

`WandbCallback()` クラスは、以下のオプションをサポートしています：

| キーワード引数    | デフォルト   | 説明                                                                                           |
| ----------------  | ----------- | ---------------------------------------------------------------------------------------------- |
| learn             | N/A         | フックする fast.ai learner を指定します。                                                          |
| save_model        | True        | 精度が向上するたびにモデルを保存します。トレーニング終了時にはベストモデルを読み込みます。                |
| mode              | auto        | `min`, `max`, または `auto`：`monitor` で指定したトレーニング指標をどのように比べるか選択します。           |
| monitor           | None        | ベストモデルを保存するためにパフォーマンスを測るトレーニングメトリクスを指定します。None の場合は validation loss になります。 |
| log               | gradients   | `gradients`, `parameters`, `all` または None。損失値やメトリクスは常にログされます。                       |
| input_type        | None        | `images` または `None`。サンプル予測の可視化に使います。                                              |
| validation_data   | None        | `input_type` が設定されている場合のサンプル予測用データ。                                              |
| predictions       | 36          | `input_type` 設定時で `validation_data` が None の場合に予測する数。                                    |
| seed              | 12345       | `input_type` 設定時で `validation_data` が None の場合のサンプル予測用ランダムシード。                        |