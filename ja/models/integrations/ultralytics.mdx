---
title: Ultralytics
---
import { ColabLink } from '/snippets/en/_includes/colab-link.mdx';

<ColabLink url="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/ultralytics/01_train_val.ipynb" />

[Ultralytics](https://github.com/ultralytics/ultralytics) は、画像分類、オブジェクト検出、画像セグメンテーション、姿勢推定などのタスク向けの、最先端のコンピュータビジョンモデルの拠点です。リアルタイムオブジェクト検出モデルの最新版である [YOLOv8](https://docs.ultralytics.com/models/yolov8/) だけでなく、[SAM (Segment Anything Model)](https://docs.ultralytics.com/models/sam/#introduction-to-sam-the-segment-anything-model)、[RT-DETR](https://docs.ultralytics.com/models/rtdetr/)、[YOLO-NAS](https://docs.ultralytics.com/models/yolo-nas/) など、他の強力なコンピュータビジョンモデルもホストしています。これらのモデルの実装に加えて、Ultralytics は使いやすい API を使用して、モデルのトレーニング、ファインチューニング、および適用を行うためのエンドツーエンドのワークフローを提供しています。

## はじめに

1. `ultralytics` と `wandb` をインストールします。

    <Tabs>
    <Tab title="コマンドライン">
    ```shell
        pip install --upgrade ultralytics==8.0.238 wandb

        # または
        # conda install ultralytics
        ```
    </Tab>
    <Tab title="ノートブック">
    ```bash
        !pip install --upgrade ultralytics==8.0.238 wandb
        ```
    </Tab>
    </Tabs>

    開発チームは `ultralyticsv8.0.238` 以下でインテグレーションのテストを行っています。インテグレーションに関する問題を報告するには、`yolov8` タグを付けて [GitHub issue](https://github.com/wandb/wandb/issues/new?template=sdk-bug.yml) を作成してください。

## 実験管理とバリデーション結果の可視化

<ColabLink url="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/ultralytics/01_train_val.ipynb" />

このセクションでは、[Ultralytics](https://docs.ultralytics.com/modes/predict/) モデルを使用したトレーニング、ファインチューニング、バリデーション、および [W&B](https://wandb.ai/site) を使用した実験管理、モデルのチェックポイント作成、パフォーマンスの可視化という典型的なワークフローを紹介します。

このインテグレーションについては、こちらのレポートもご覧ください： [Supercharging Ultralytics with W&B](https://wandb.ai/geekyrakshit/ultralytics/reports/Supercharging-Ultralytics-with-Weights-Biases--Vmlldzo0OTMyMDI4)

Ultralytics で W&B インテグレーションを使用するには、`wandb.integration.ultralytics.add_wandb_callback` 関数をインポートします。

```python
import wandb
from wandb.integration.ultralytics import add_wandb_callback

from ultralytics import YOLO
```

任意の `YOLO` モデルを初期化し、推論を実行する前に `add_wandb_callback` 関数を呼び出します。これにより、トレーニング、ファインチューニング、バリデーション、または推論を実行した際に、実験ログと画像が自動的に保存されます。画像には、W&B の [コンピュータビジョンタスク向けのインタラクティブ・オーバーレイ](/models/track/log/media/#image-overlays-in-tables) を使用して、正解ラベル（ground-truth）とそれぞれの予測結果が重ねて表示され、詳細なインサイトと共に [`wandb.Table`](/models/tables/) に記録されます。

```python
with wandb.init(project="ultralytics", job_type="train") as run:

    # YOLOモデルの初期化
    model = YOLO("yolov8n.pt")

    # Ultralytics用のW&Bコールバックを追加
    add_wandb_callback(model, enable_model_checkpointing=True)

    # モデルのトレーニング/ファインチューニング
    # 各エポックの終了時に、バリデーションバッチの予測結果が
    # コンピュータビジョンタスク向けの洞察に満ちたインタラクティブなオーバーレイと共に
    # W&B Tableにログとして記録されます
    model.train(project="ultralytics", data="coco128.yaml", epochs=5, imgsz=640)
```

Ultralytics のトレーニングまたはファインチューニングワークフローで W&B を使用して実験管理を行うと、以下のようになります：

<blockquote class="imgur-embed-pub" lang="en" data-id="a/TB76U9O"  ><a href="https://imgur.com/a/TB76U9O">YOLO Fine-tuning Experiments</a></blockquote><script async src="https://s.imgur.com/min/embed.js" charset="utf-8"></script>


エポックごとのバリデーション結果が [W&B Table](/models/tables/) を使用してどのように可視化されるかは以下の通りです：

<blockquote class="imgur-embed-pub" lang="en" data-id="a/kU5h7W4"  ><a href="https://imgur.com/a/kU5h7W4">WandB Validation Visualization Table</a></blockquote><script async src="https://s.imgur.com/min/embed.js" charset="utf-8"></script>


## 予測結果の可視化

<ColabLink url="https://colab.research.google.com/github/wandb/examples/blob/master/colabs/ultralytics/00_inference.ipynb" />

このセクションでは、[Ultralytics](https://docs.ultralytics.com/modes/predict/) モデルを推論に使用し、その結果を [W&B](https://wandb.ai/site) で可視化する典型的なワークフローを紹介します。

Google Colab でコードを試すことができます： [Open in Colab](https://wandb.me/ultralytics-inference)

このインテグレーションについては、こちらのレポートもご覧ください： [Supercharging Ultralytics with W&B](https://wandb.ai/geekyrakshit/ultralytics/reports/Supercharging-Ultralytics-with-Weights-Biases--Vmlldzo0OTMyMDI4)

Ultralytics で W&B インテグレーションを使用するには、`wandb.integration.ultralytics.add_wandb_callback` 関数をインポートする必要があります。

```python
import wandb
from wandb.integration.ultralytics import add_wandb_callback

from ultralytics.engine.model import YOLO
```

インテグレーションをテストするためにいくつかの画像をダウンロードします。静止画、動画、またはカメラソースを使用できます。推論ソースの詳細については、[Ultralytics docs](https://docs.ultralytics.com/modes/predict/) を参照してください。

```bash
!wget https://raw.githubusercontent.com/wandb/examples/ultralytics/colabs/ultralytics/assets/img1.png
!wget https://raw.githubusercontent.com/wandb/examples/ultralytics/colabs/ultralytics/assets/img2.png
!wget https://raw.githubusercontent.com/wandb/examples/ultralytics/colabs/ultralytics/assets/img4.png
!wget https://raw.githubusercontent.com/wandb/examples/ultralytics/colabs/ultralytics/assets/img5.png
```

`wandb.init()` を使用して W&B [run](/models/runs/) を初期化します。次に、希望の `YOLO` モデルを初期化し、推論を実行する前に `add_wandb_callback` 関数を呼び出します。これにより、推論を実行した際に、[コンピュータビジョンタスク向けのインタラクティブ・オーバーレイ](/models/track/log/media/#image-overlays-in-tables) が重ねられた画像が、詳細なインサイトと共に [`wandb.Table`](/models/tables/) に自動的にログとして記録されます。

```python
# W&B Runを初期化
with wandb.init(project="ultralytics", job_type="inference") as run:
    # YOLOモデルを初期化
    model = YOLO("yolov8n.pt")

    # Ultralytics用のW&Bコールバックを追加
    add_wandb_callback(model, enable_model_checkpointing=True)

    # 予測を実行。バウンディングボックスやセグメンテーションマスクの
    # インタラクティブなオーバーレイと共にW&B Tableへ自動的にログを記録します
    model(
        [
            "./assets/img1.jpeg",
            "./assets/img3.png",
            "./assets/img4.jpeg",
            "./assets/img5.jpeg",
        ]
    )
```

トレーニングやファインチューニングのワークフローでは、`wandb.init()` を使用して明示的に run を初期化する必要はありません。ただし、コードに予測のみが含まれる場合は、明示的に run を作成する必要があります。

インタラクティブな bbox オーバーレイの表示例です：

<blockquote class="imgur-embed-pub" lang="en" data-id="a/UTSiufs"  ><a href="https://imgur.com/a/UTSiufs">WandB Image Overlay</a></blockquote><script async src="https://s.imgur.com/min/embed.js" charset="utf-8"></script>


詳細については、[W&B 画像オーバーレイガイド](/models/track/log/media/#image-overlays) を参照してください。

## その他のリソース

* [Supercharging Ultralytics with W&B](https://wandb.ai/geekyrakshit/ultralytics/reports/Supercharging-Ultralytics-with-Weights-Biases--Vmlldzo0OTMyMDI4)
* [Object Detection using YOLOv8: An End-to-End Workflow](https://wandb.ai/reviewco/object-detection-bdd/reports/Object-Detection-using-YOLOv8-An-End-to-End-Workflow--Vmlldzo1NTAyMDQ1)