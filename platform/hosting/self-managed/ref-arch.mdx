---
title: Reference Architecture
description: W&B Reference Architecture
---

import SelfManagedVersionRequirements from "/snippets/en/_includes/self-managed-version-requirements.mdx";
import SelfManagedNetworkingRequirements from "/snippets/en/_includes/self-managed-networking-requirements.mdx";
import SelfManagedSslTlsRequirements from "/snippets/en/_includes/self-managed-ssl-tls-requirements.mdx";

This page describes a reference architecture for a W&B deployment and outlines the recommended infrastructure and resources to support a production deployment of the platform.

Depending on your chosen deployment environment for W&B, various services can help to enhance the resiliency of your deployment.

For instance, major cloud providers offer robust managed database services which help to reduce the complexity of database configuration, maintenance, high availability, and resilience.

This reference architecture addresses some common deployment scenarios and shows how you can integrate your W&B deployment with cloud vendor services for optimal performance and reliability.

## Before you start

Running any application in production comes with its own set of challenges, and W&B is no exception. While we aim to streamline the process, certain complexities may arise depending on your unique architecture and design decisions. Typically, managing a production deployment involves overseeing various components, including hardware, operating systems, networking, storage, security, the W&B platform itself, and other dependencies. This responsibility extends to both the initial setup of the environment and its ongoing maintenance.

Consider carefully whether a Self-Managed approach with W&B is suitable for your team and specific requirements.

A strong understanding of how to run and maintain production-grade application is an important prerequisite before you deploy Self-Managed W&B. If your team needs assistance, our Professional Services team and partners offer support for implementation and optimization.

To learn more about managed solutions for running W&B instead of managing it yourself, refer to [W&B Multi-tenant Cloud](/platform/hosting/hosting-options/multi_tenant_cloud) and [W&B Dedicated Cloud](/platform/hosting/hosting-options/dedicated_cloud).

## Infrastructure

<Frame>
    <img src="/images/hosting/reference_architecture.png" alt="W&B infrastructure diagram"  />
</Frame>

### Application layer

The application layer consists of a multi-node Kubernetes cluster, with resilience against node failures. The Kubernetes cluster runs and maintains W&B's pods.

### Storage layer

The storage layer consists of a MySQL database and object storage. The MySQL database stores metadata and the object storage stores artifacts such as models and datasets.

## Infrastructure requirements

### Kubernetes
The W&B Server application is deployed as a [Kubernetes Operator](/platform/hosting/operator/) that deploys multiple pods. For this reason, W&B requires a Kubernetes cluster with:
- A fully configured and functioning Ingress controller.
- The capability to provision Persistent Volumes.

W&B supports deployment on [OpenShift Kubernetes clusters](https://www.redhat.com/en/technologies/cloud-computing/openshift) in cloud, on-premises, and air-gapped environments. For specific configuration instructions, see the [OpenShift section](/platform/hosting/operator/#openshift-kubernetes-clusters) in the Operator guide.

### MySQL
W&B stores metadata in a MySQL database. The database's performance and storage requirements depend on the shapes of the model parameters and related metadata. For example, the database grows in size as you track more training runs, and load on the database increases based on queries in run tables, user workspaces, and reports.

**W&B strongly recommends using managed database services** (such as AWS RDS Aurora MySQL, Google Cloud SQL for MySQL, or Azure Database for MySQL) for production deployments. Managed services provide automated backups, monitoring, high availability, patching, and significantly reduce operational complexity. See the [Cloud provider instance recommendations](#cloud-provider-instance-recommendations) section below for specific service recommendations.

If you choose to deploy a self-managed MySQL database, consider the following:

- **Backups**. You should periodically back up the database to a separate facility. W&B recommends daily backups with at least 1 week of retention.
- **Performance.** The disk the server is running on should be fast. W&B recommends running the database on an SSD or accelerated NAS.
- **Monitoring.** The database should be monitored for load. If CPU usage is sustained at > 40% of the system for more than 5 minutes it is likely a good indication the server is resource starved.
- **Availability.** Depending on your availability and durability requirements you might want to configure a hot standby on a separate machine that streams all updates in realtime from the primary server and can be used to failover to in the event that the primary server crashes or become corrupted.

#### MySQL database creation

For instructions to manually create the MySQL database and user, see the [bare-metal guide MySQL database section](/platform/hosting/self-managed/bare-metal/#mysql-database).

#### MySQL configuration parameters

If you are running your own MySQL instance, configure MySQL with these settings:

```
binlog_format = 'ROW'
binlog_row_image = 'MINIMAL'
innodb_flush_log_at_trx_commit = 1
innodb_online_alter_log_max_size = 268435456
max_prepared_stmt_count = 1048576
sort_buffer_size = '67108864'
sync_binlog = 1
```

These settings have been validated by W&B for optimal performance and reliability.

### Redis
W&B depends on a single-node Redis 7.x deployment used by W&B's components for job queuing and data caching. For convenience during testing and development of proofs of concept, W&B Self-Managed includes a local Redis deployment that is not appropriate for production deployments.

W&B can connect to a Redis instance in the following environments:

- [AWS Elasticache](https://aws.amazon.com/pm/elasticache/)
- [Google Cloud Memory Store](https://cloud.google.com/memorystore?hl=en)
- [Azure Cache for Redis](https://azure.microsoft.com/en-us/products/cache)
- Redis deployment hosted in your cloud or on-premise infrastructure

### Object storage
W&B requires object storage with pre-signed URL and CORS support, deployed in one of:

- [CoreWeave AI Object Storage](https://docs.coreweave.com/docs/products/storage/object-storage) is a high-performance, S3-compatible object storage service optimized for AI workloads.
- [Amazon S3](https://aws.amazon.com/s3/) is an object storage service offering industry-leading scalability, data availability, security, and performance.
- [Google Cloud Storage](https://cloud.google.com/storage) is a managed service for storing unstructured data at scale.
- [Azure Blob Storage](https://azure.microsoft.com/products/storage/blobs) is a cloud-based object storage solution for storing massive amounts of unstructured data like text, binary data, images, videos, and logs.
- S3-compatible storage like [MinIO](https://github.com/minio/minio) hosted in your cloud or infrastructure on your premises.

### Versions
<SelfManagedVersionRequirements/>

### Networking

<SelfManagedNetworkingRequirements/>

### DNS
The fully qualified domain name (FQDN) of the W&B deployment must resolve to the IP address of the ingress/load balancer using an A record.

### Load balancer and ingress

Run a load balancer that stops network requests at the appropriate network boundary. Ensure that all machines used to execute machine learning payloads, and the devices used to access the service through web browsers, can communicate to this endpoint.

Common load balancer and ingress controller options include:
1. [Nginx Ingress](https://kubernetes.github.io/ingress-nginx/)
2. [Istio](https://istio.io)
3. [Caddy](https://caddyserver.com)
4. [Cloudflare](https://www.cloudflare.com/load-balancing/)
5. [Apache](https://www.apache.org)
6. [HAProxy](https://www.haproxy.org)

#### Example nginx configuration

The following is an example configuration using nginx as a reverse proxy:

```nginx
events {}
http {
    # If we receive X-Forwarded-Proto, pass it through; otherwise, pass along the
    # scheme used to connect to this server
    map $http_x_forwarded_proto $proxy_x_forwarded_proto {
        default $http_x_forwarded_proto;
        ''      $scheme;
    }

    # Also, in the above case, force HTTPS
    map $http_x_forwarded_proto $sts {
        default '';
        "https" "max-age=31536000; includeSubDomains";
    }

    # If we receive X-Forwarded-Host, pass it though; otherwise, pass along $http_host
    map $http_x_forwarded_host $proxy_x_forwarded_host {
        default $http_x_forwarded_host;
        ''      $http_host;
    }

    # If we receive X-Forwarded-Port, pass it through; otherwise, pass along the
    # server port the client connected to
    map $http_x_forwarded_port $proxy_x_forwarded_port {
        default $http_x_forwarded_port;
        ''      $server_port;
    }

    # If we receive Upgrade, set Connection to "upgrade"; otherwise, delete any
    # Connection header that may have been passed to this server
    map $http_upgrade $proxy_connection {
        default upgrade;
        '' close;
    }

    server {
        listen 443 ssl;
        server_name         www.example.com;
        ssl_certificate     www.example.com.crt;
        ssl_certificate_key www.example.com.key;

        proxy_http_version 1.1;
        proxy_buffering off;
        proxy_set_header Host $http_host;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection $proxy_connection;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $proxy_x_forwarded_proto;
        proxy_set_header X-Forwarded-Host $proxy_x_forwarded_host;

        location / {
            proxy_pass  http://$YOUR_UPSTREAM_SERVER_IP:8080/;
        }

        keepalive_timeout 10;
    }
}
```

### SSL/TLS
<SelfManagedSslTlsRequirements/>

### Supported CPU architectures
W&B runs on the Intel (x86) CPU architecture. ARM is not supported.

## Deployment method

### Recommended: W&B Kubernetes Operator with Helm
The recommended installation method for W&B Self-Managed is using the **W&B Kubernetes Operator**, deployed via Helm. This approach provides:
- Automated updates and management of W&B components
- Simplified configuration and deployment
- Support for all deployment scenarios (cloud, on-premises, air-gapped)

For detailed installation instructions, see:
- [Run W&B Server on Kubernetes (Operator)](/platform/hosting/operator/) - Primary installation guide
- [Deploy W&B Platform On-premises](/platform/hosting/self-managed/bare-metal/) - For datacenter/bare-metal specific considerations
- [Kubernetes operator for air-gapped instances](/platform/hosting/self-managed/operator-airgapped/) - For disconnected environments

### Infrastructure provisioning
Terraform is the recommended way to provision infrastructure for W&B production deployments. Using Terraform, you define the required resources, their references to other resources, and their dependencies. W&B provides Terraform modules for the major cloud providers. For details, refer to [Deploy W&B Server within Self-Managed cloud accounts](/platform/hosting/hosting-options/self-managed#deploy-wb-server-within-Self-Managed-cloud-accounts).

## Sizing
Use the following general guidelines as a starting point when planning a deployment. W&B recommends that you monitor all components of a new deployment closely and that you make adjustments based on observed usage patterns. Continue to monitor production deployments over time and make adjustments as needed to maintain optimal performance.

### Models only

#### Kubernetes

| Environment      | CPU	            | Memory	         | Disk               | 
| ---------------- | ------------------ | ------------------ | ------------------ | 
| Test/Dev         | 2 cores            | 16 GB              | 100 GB             |
| Production       | 8 cores            | 64 GB              | 100 GB             |

Numbers are per Kubernetes worker node.

#### MySQL

| Environment      | CPU	            | Memory	         | Disk               | 
| ---------------- | ------------------ | ------------------ | ------------------ | 
| Test/Dev         | 2 cores            | 16 GB              | 100 GB             |
| Production       | 8 cores            | 64 GB              | 500 GB             |

Numbers are per MySQL node.


### Weave only

#### Kubernetes

| Environment      | CPU                | Memory             | Disk               | 
| ---------------- | ------------------ | ------------------ | ------------------ | 
| Test/Dev         | 4 cores            | 32 GB              | 100 GB             |
| Production       | 12 cores           | 96 GB              | 100 GB             |

Numbers are per Kubernetes worker node.

#### MySQL

| Environment      | CPU                | Memory             | Disk               | 
| ---------------- | ------------------ | ------------------ | ------------------ | 
| Test/Dev         | 2 cores            | 16 GB              | 100 GB             |
| Production       | 8 cores            | 64 GB              | 500 GB             |

Numbers are per MySQL node.

### Models and Weave

#### Kubernetes

| Environment      | CPU                | Memory             | Disk               | 
| ---------------- | ------------------ | ------------------ | ------------------ | 
| Test/Dev         | 4 cores            | 32 GB              | 100 GB             |
| Production       | 16 cores           | 128 GB             | 100 GB             |

Numbers are per Kubernetes worker node.

#### MySQL

| Environment      | CPU                | Memory             | Disk               | 
| ---------------- | ------------------ | ------------------ | ------------------ | 
| Test/Dev         | 2 cores            | 16 GB              | 100 GB             |
| Production       | 8 cores            | 64 GB              | 500 GB             |

Numbers are per MySQL node.

## Cloud provider instance recommendations

### Services

| Cloud       | Kubernetes	 | MySQL	                | Object Storage             |   
| ----------- | ------------ | ------------------------ | -------------------------- | 
| AWS         | EKS          | RDS Aurora               | S3                         |
| Google Cloud         | GKE          | Google Cloud SQL - Mysql | Google Cloud Storage (GCS) |
| Azure       | AKS          | Azure Database for Mysql | Azure Blob Storage         |


### Machine types

These recommendations apply to each node of a Self-Managed deployment of W&B in cloud infrastructure.

#### AWS

| Environment | K8s (Models only)  | K8s (Weave only)   | K8s (Models&Weave)  | MySQL	           |  
| ----------- | ------------------ | ------------------ | ------------------- | ------------------ |  
| Test/Dev    | r6i.large          | r6i.xlarge         | r6i.xlarge          | db.r6g.large       | 
| Production  | r6i.2xlarge        | r6i.4xlarge        | r6i.4xlarge         | db.r6g.2xlarge     | 

#### Google Cloud

| Environment | K8s (Models only)  | K8s (Weave only)   | K8s (Models&Weave)  | MySQL              |  
| ----------- | ------------------ | ------------------ | ------------------- | ------------------ |  
| Test/Dev    | n2-highmem-2       | n2-highmem-4       | n2-highmem-4        | db-n1-highmem-2    | 
| Production  | n2-highmem-8       | n2-highmem-16      | n2-highmem-16       | db-n1-highmem-8    | 

#### Azure

| Environment | K8s (Models only)  | K8s (Weave only)   | K8s (Models&Weave)  | MySQL               |  
| ----------- | ------------------ | ------------------ | ------------------- | ------------------- |  
| Test/Dev    | Standard_E2_v5     | Standard_E4_v5     | Standard_E4_v5      | MO_Standard_E2ds_v4 | 
| Production  | Standard_E8_v5     | Standard_E16_v5    | Standard_E16_v5     | MO_Standard_E8ds_v4 | 
