---
description: Sweeps 빠른 시작에서는 스위프를 정의하고, 초기화하고, 실행하는 방법을
  설명합니다. 네 가지 주요 단계가 있습니다.
title: '튜토리얼: 스위프를 정의하고, 초기화하고, 실행하기'
---

이 페이지에서는 스위프를 정의하고, 초기화하고, 실행하는 방법을 설명합니다. 네 가지 주요 단계가 있습니다:

1. [학습 코드 설정](#set-up-your-training-code)
2. [스위프 구성으로 탐색 공간 정의](#define-the-search-space-with-a-sweep-configuration)
3. [스위프 초기화](#initialize-the-sweep)
4. [스위프 에이전트 시작](#start-the-sweep)

다음 코드를 복사해서 Jupyter Notebook 또는 Python 스크립트에 붙여넣으세요:

```python
# W&B Python 라이브러리를 가져오고 W&B에 로그인
import wandb

# 1: 목적/학습 함수 정의
def objective(config):
    score = config.x**3 + config.y
    return score

def main():
    with wandb.init(project="my-first-sweep") as run:
        score = objective(run.config)
        run.log({"score": score})

# 2: 탐색 공간 정의
sweep_configuration = {
    "method": "random",
    "metric": {"goal": "minimize", "name": "score"},
    "parameters": {
        "x": {"max": 0.1, "min": 0.01},
        "y": {"values": [1, 3, 7]},
    },
}

# 3: Sweep 시작
sweep_id = wandb.sweep(sweep=sweep_configuration, project="my-first-sweep")

wandb.agent(sweep_id, function=main, count=10)
```

다음 섹션에서 코드 예제의 각 단계를 차례대로 설명합니다.

<div id="set-up-your-training-code">
  ## 학습 코드를 설정합니다
</div>

`wandb.Run.config`에서 하이퍼파라미터 값을 받아 이를 사용해 모델을 학습하고, 메트릭을 반환하는 학습 함수를 정의합니다.

원한다면 W&amp;B 실행 결과가 저장될 프로젝트 이름을 지정할 수 있습니다 (`wandb.init()`의 project 파라미터, [`wandb.init()`](/ko/models/ref/python/functions/init) 참조). 프로젝트를 지정하지 않으면 실행은 &quot;Uncategorized&quot; 프로젝트에 저장됩니다.

<Note>
  스윕과 실행은 반드시 같은 프로젝트에 있어야 합니다. 따라서 W&amp;B를 초기화할 때 제공하는 프로젝트 이름은 스윕을 초기화할 때 제공하는 프로젝트 이름과 일치해야 합니다.
</Note>

```python
# 1: 목적/학습 함수 정의
def objective(config):
    score = config.x**3 + config.y
    return score


def main():
    with wandb.init(project="my-first-sweep") as run:
        score = objective(run.config)
        run.log({"score": score})
```

<div id="define-the-search-space-with-a-sweep-configuration">
  ## 스윕 설정으로 검색 공간 정의하기
</div>

딕셔너리에서 스윕할 하이퍼파라미터를 지정합니다. 설정 옵션은 [스윕 설정 정의](/ko/models/sweeps/define-sweep-configuration/)를 참조하세요.

다음 예시는 랜덤 서치(`'method':'random'`)를 사용하는 스윕 설정을 보여줍니다. 이 스윕은 설정에 나열된 배치 크기, epoch, 학습률 값들 중에서 무작위 조합을 선택합니다.

`"goal": "minimize"`가 `metric` 키와 함께 지정된 경우, W&amp;B는 해당 메트릭을 최소화합니다. 이 예시에서는 W&amp;B가 메트릭 `score` (`"name": "score"`)를 최소화하도록 최적화합니다.

```python
# 2: 탐색 공간 정의
sweep_configuration = {
    "method": "random",
    "metric": {"goal": "minimize", "name": "score"},
    "parameters": {
        "x": {"max": 0.1, "min": 0.01},
        "y": {"values": [1, 3, 7]},
    },
}
```

<div id="initialize-the-sweep">
  ## Sweep 초기화
</div>

W&amp;B는 클라우드(standard) 또는 하나 이상의 머신에 걸친 로컬(local) 환경에서 sweep을 관리하기 위해 *Sweep Controller*를 사용합니다. Sweep Controller에 대한 자세한 내용은 [Search and stop algorithms locally](./local-controller)를 참조하세요.

Sweep을 초기화하면 sweep ID가 반환됩니다:

```python
sweep_id = wandb.sweep(sweep=sweep_configuration, project="my-first-sweep")
```

스윕 초기화에 대한 자세한 내용은 [Initialize sweeps](./initialize-sweeps)를 참고하세요.

<div id="start-the-sweep">
  ## Sweep 시작하기
</div>

[`wandb.agent()`](/ko/models/ref/python/functions/agent) API를 호출해 sweep을 시작합니다.

```python
wandb.agent(sweep_id, function=main, count=10)
```

<Warning>
  **멀티프로세싱**

  Python 표준 라이브러리의 `multiprocessing` 또는 PyTorch의 `pytorch.multiprocessing` 패키지를 사용하는 경우, `wandb.agent()` 및 `wandb.sweep()` 호출을 `if __name__ == '__main__':` 블록으로 감싸야 합니다. 예를 들어:

  ```python
  if __name__ == '__main__':
      wandb.agent(sweep_id="<sweep_id>", function="<function>", count="<count>")
  ```

  이 관례를 사용해 코드를 감싸면 스크립트가 직접 실행될 때만 코드가 실행되고, 워커 프로세스에서 모듈로 import될 때는 실행되지 않도록 보장합니다.

  멀티프로세싱에 대한 더 자세한 내용은 [Python 표준 라이브러리 `multiprocessing`](https://docs.python.org/3/library/multiprocessing.html#the-spawn-and-forkserver-start-methods) 또는 [PyTorch `multiprocessing`](https://docs.pytorch.org/docs/stable/notes/multiprocessing.html#asynchronous-multiprocess-training-e-g-hogwild)를 참고하세요. `if __name__ == '__main__':` 관례에 대한 정보는 https://realpython.com/if-name-main-python/를 참고하세요.
</Warning>

<div id="visualize-results-optional">
  ## 결과 시각화(선택 사항)
</div>

W&amp;B 앱 대시보드에서 프로젝트를 열어 실시간 결과를 확인하세요. 몇 번만 클릭하면 [평행좌표 플롯](/ko/models/app/features/panels/parallel-coordinates/), [매개변수 중요도 분석](/ko/models/app/features/panels/parameter-importance/), [추가 차트 유형](/ko/models/app/features/panels/) 등의 풍부한 인터랙티브 차트를 만들 수 있습니다.

<Frame>
  <img src="/images/sweeps/quickstart_dashboard_example.png" alt="Sweeps 대시보드 예시" />
</Frame>

결과를 시각화하는 방법에 대한 자세한 내용은 [Visualize sweep results](./visualize-sweep-results)를 참조하세요. 대시보드 예시는 이 예제 [Sweeps 프로젝트](https://wandb.ai/anmolmann/pytorch-cnn-fashion/sweeps/pmqye6u3)를 참고하세요.

<div id="stop-the-agent-optional">
  ## 에이전트 중지하기 (선택 사항)
</div>

터미널에서 `Ctrl+C`를 눌러 현재 실행을 중단합니다. 한 번 더 눌러 에이전트를 종료합니다.