---
description: W&B를 Ray Tune과 인테그레이션하는 방법.
title: Ray Tune
---

W&B는 [Ray](https://github.com/ray-project/ray)와 통합하기 위해 두 가지 경량 인테그레이션을 제공합니다.

- `WandbLoggerCallback` 함수는 Tune에 리포트된 메트릭을 wandb API에 자동으로 로깅합니다.
- 함수 API와 함께 사용할 수 있는 `setup_wandb()` 함수는 Tune의 트레이닝 정보를 사용해 wandb API를 자동으로 초기화합니다. 예를 들어 `run.log()`를 사용해 트레이닝 과정을 로깅하는 등, 평소와 같이 wandb API를 사용할 수 있습니다.

<div id="configure-the-integration">
  ## 인테그레이션 구성
</div>

```python
from ray.air.integrations.wandb import WandbLoggerCallback
```

Wandb 설정은 wandb 키를 `tune.run()`의 config 매개변수에 전달해서 수행합니다(아래 예시 참고).

wandb 설정 항목의 내용은 키워드 인수로 `wandb.init()`에 전달됩니다. 단, 다음 설정들은 `WandbLoggerCallback` 자체를 설정하는 데 사용됩니다.


<div id="parameters">
  ### Parameters
</div>

`project (str)`: wandb 프로젝트 이름입니다. 필수입니다.

`api_key_file (str)`: wandb API 키가 포함된 파일의 경로입니다.

`api_key (str)`: wandb API 키입니다. `api_key_file`을 설정하는 대신 사용할 수 있습니다.

`excludes (list)`: 로그에서 제외할 메트릭 목록입니다.

`log_config (bool)`: 결과 사전의 config 파라미터를 로그로 남길지 여부입니다. 기본값은 False입니다.

`upload_checkpoints (bool)`:  True인 경우, 모델 체크포인트가 아티팩트로 업로드됩니다. 기본값은 False입니다.

<div id="example">
  ### 예제
</div>

```python
from ray import tune, train
from ray.air.integrations.wandb import WandbLoggerCallback


def train_fc(config):
    for i in range(10):
        train.report({"mean_accuracy": (i + config["alpha"]) / 10})


tuner = tune.Tuner(
    train_fc,
    param_space={
        "alpha": tune.grid_search([0.1, 0.2, 0.3]),
        "beta": tune.uniform(0.5, 1.0),
    },
    run_config=train.RunConfig(
        callbacks=[
            WandbLoggerCallback(
                project="<your-project>", api_key="<your-api-key>", log_config=True
            )
        ]
    ),
)

results = tuner.fit()
```


<div id="setup_wandb">
  ## setup_wandb
</div>

```python
from ray.air.integrations.wandb import setup_wandb
```

이 유틸리티 함수는 Ray Tune과 함께 사용할 수 있도록 wandb를 초기화하는 데 도움이 됩니다. 기본적인 사용법으로는 트레이닝 함수에서 `setup_wandb()`를 호출하면 됩니다.

```python
from ray.air.integrations.wandb import setup_wandb


def train_fn(config):
    # wandb 초기화
    wandb = setup_wandb(config)
    run = wandb.init(
        project=config["wandb"]["project"],
        api_key_file=config["wandb"]["api_key_file"],
    )

    for i in range(10):
        loss = config["a"] + config["b"]
        run.log({"loss": loss})
        tune.report(loss=loss)
    run.finish()


tuner = tune.Tuner(
    train_fn,
    param_space={
        # 여기에 탐색 공간 정의
        "a": tune.choice([1, 2, 3]),
        "b": tune.choice([4, 5, 6]),
        # wandb 설정
        "wandb": {"project": "Optimization_Project", "api_key_file": "/path/to/file"},
    },
)
results = tuner.fit()
```


<div id="example-code">
  ## 예제 코드
</div>

인테그레이션이 어떻게 작동하는지 확인할 수 있도록 몇 가지 예제를 준비했습니다:

* [Colab](https://wandb.me/raytune-colab): 인테그레이션을 간단히 시험해 볼 수 있는 데모입니다.
* [Dashboard](https://wandb.ai/anmolmann/ray_tune): 예제에서 생성된 대시보드를 확인해 보세요.