---
title: Webhook 자동화 생성하기
---
import EnterpriseCloudOnly from "/snippets/en/_includes/enterprise-cloud-only.mdx";

<Info>
<EnterpriseCloudOnly/>
</Info>

이 페이지는 webhook [automation](/models/automations/)을 생성하는 방법을 보여줍니다. Slack 자동화를 생성하려면 [Create a Slack automation](/models/automations/create-automations/slack/)을 대신 참조하세요.

개괄적으로, webhook 자동화를 생성하려면 다음 단계를 따릅니다:
1. 필요한 경우, 엑세스 토큰, 비밀번호 또는 SSH 키와 같이 자동화에 필요한 각 민감한 문자열에 대해 [W&B secret을 생성](/platform/secrets/)합니다. Secrets는 **Team Settings**에서 정의됩니다.
1. 엔드포인트 및 인증 세부 정보를 정의하고 인테그레이션에 필요한 secrets에 대한 엑세스 권한을 부여하기 위해 [webhook을 생성](#create-a-webhook)합니다.
1. 모니터링할 [event](/models/automations/automation-events/)와 W&B가 보낼 페이로드를 정의하기 위해 [automation을 생성](#create-an-automation)합니다. 페이로드에 필요한 secrets에 대한 엑세스 권한을 자동화에 부여합니다.

## Create a webhook
팀 관리자는 팀을 위한 webhook을 추가할 수 있습니다.

<Note>
webhook에 Bearer 토큰이 필요하거나 페이로드에 민감한 문자열이 필요한 경우, webhook을 생성하기 전에 [해당 내용을 포함하는 secret을 생성](/platform/secrets/#add-a-secret)하세요. webhook 하나당 최대 하나의 엑세스 토큰과 하나의 기타 secret을 설정할 수 있습니다. webhook의 인증 및 권한 부여 요구 사항은 webhook 서비스에 의해 결정됩니다.
</Note>

1. W&B에 로그인하고 **Team Settings** 페이지로 이동합니다.
1. **Webhooks** 섹션에서 **New webhook**을 클릭합니다.
1. webhook의 이름을 입력합니다. 
1. webhook의 엔드포인트 URL을 입력합니다.
1. webhook에 Bearer 토큰이 필요한 경우, **Access token**을 해당 토큰이 포함된 [secret](/platform/secrets/)으로 설정합니다. webhook 자동화를 사용할 때 W&B는 `Authorization: Bearer` HTTP 헤더를 엑세스 토큰으로 설정하며, `${ACCESS_TOKEN}` [payload variable](#payload-variables)을 통해 토큰에 엑세스할 수 있습니다. W&B가 webhook 서비스로 보내는 `POST` 요청의 구조에 대한 자세한 내용은 [Troubleshoot your webhook](#troubleshoot-your-webhook)에서 확인하세요.
1. webhook의 페이로드에 비밀번호나 기타 민감한 문자열이 필요한 경우, **Secret**을 해당 문자열이 포함된 secret으로 설정합니다. 해당 webhook을 사용하는 자동화를 구성할 때, 이름 앞에 `$`를 붙여 [payload variable](#payload-variables)로서 secret에 엑세스할 수 있습니다.

    webhook의 엑세스 토큰이 secret에 저장된 경우, 해당 secret을 엑세스 토큰으로 지정하기 위해 다음 단계도 _반드시_ 완료해야 합니다.
1. W&B가 엔드포인트에 연결 및 인증할 수 있는지 확인하려면:
    1. 선택적으로, 테스트할 페이로드를 제공합니다. 페이로드 내에서 webhook이 엑세스 권한을 가진 secret을 참조하려면 이름 앞에 `$`를 붙입니다. 이 페이로드는 테스트용으로만 사용되며 저장되지 않습니다. 자동화의 페이로드는 [automation을 생성](#create-a-webhook-automation)할 때 구성합니다. `POST` 요청에서 secret과 엑세스 토큰이 지정되는 위치를 보려면 [Troubleshoot your webhook](#troubleshoot-your-webhook)을 참조하세요.
    1. **Test**를 클릭합니다. W&B는 구성된 자격 증명을 사용하여 webhook의 엔드포인트 연결을 시도합니다. 페이로드를 제공한 경우 W&B가 이를 전송합니다.

    테스트가 성공하지 못하면 webhook 설정을 확인하고 다시 시도하세요. 필요한 경우 [Troubleshoot your webhook](#troubleshoot-your-webhook)을 참조하세요.

<Frame>
![팀 내 두 개의 webhook을 보여주는 스크린샷](/images/automations/webhooks.png)
</Frame>

이제 해당 webhook을 사용하는 [automation을 생성](#create-a-webhook-automation)할 수 있습니다.

## Create an automation
[webhook을 구성](#create-a-webhook)한 후, **Registry** 또는 **Project**를 선택한 다음 아래 단계에 따라 webhook을 트리거하는 자동화를 생성합니다.

<Tabs>
<Tab header="Registry">
Registry 관리자는 해당 registry에서 자동화를 생성할 수 있습니다. Registry 자동화는 미래에 추가될 컬렉션을 포함하여 registry 내의 모든 컬렉션에 적용됩니다.

1. W&B에 로그인합니다.
1. 세부 정보를 보려면 registry의 이름을 클릭합니다. 
1. registry 범위의 자동화를 생성하려면 **Automations** 탭을 클릭한 다음 **Create automation**을 클릭합니다. 

1. 모니터링할 [event](/models/automations/automation-events/#registry-events)를 선택합니다.

    추가로 나타나는 필드를 채웁니다. 예를 들어, **An artifact alias is added**를 선택하면 **Alias regex**를 지정해야 합니다.

    **Next step**을 클릭합니다.
1. [webhook](#create-a-webhook)을 소유한 팀을 선택합니다.
1. **Action type**을 **Webhooks**로 설정한 다음 사용할 [webhook](#create-a-webhook)을 선택합니다.
1. webhook에 엑세스 토큰을 구성한 경우, `${ACCESS_TOKEN}` [payload variable](#payload-variables)을 통해 토큰에 엑세스할 수 있습니다. webhook에 secret을 구성한 경우, 이름 앞에 `$`를 붙여 페이로드에서 해당 secret에 엑세스할 수 있습니다. webhook의 요구 사항은 webhook 서비스에 의해 결정됩니다.
1. **Next step**을 클릭합니다.
1. 자동화의 이름을 입력합니다. 선택적으로 설명을 입력할 수 있습니다. **Create automation**을 클릭합니다.
</Tab>
<Tab header="Project">
W&B 관리자는 프로젝트에서 자동화를 생성할 수 있습니다.

1. W&B에 로그인하고 프로젝트 페이지로 이동합니다.
1. 사이드바에서 **Automations**를 클릭한 다음 **Create automation**을 클릭합니다.

    또는 워크스페이스의 라인 플롯에서 해당 메트릭에 대한 [run metric automation](/models/automations/automation-events/#run-events)을 빠르게 생성할 수 있습니다. 패널 위에 마우스를 올린 다음 패널 상단의 벨 아이콘을 클릭합니다.
    <Frame>
    <img src="/images/automations/run_metric_automation_from_panel.png" alt="자동화 벨 아이콘 위치"  />
    </Frame>
1. 아티팩트 에일리어스가 추가되거나 run 메트릭이 특정 임계값에 도달하는 경우와 같이 모니터링할 [event](/models/automations/automation-events/#project)를 선택합니다.

    1. 이벤트에 따라 나타나는 추가 필드를 채웁니다. 예를 들어, **An artifact alias is added**를 선택하면 **Alias regex**를 지정해야 합니다.

        1. run에 의해 트리거되는 자동화의 경우, 선택적으로 하나 이상의 run 필터를 지정합니다.

            - **Filter to one user's runs**: 특정 사용자가 생성한 run만 포함합니다. 토글을 클릭하여 필터를 켠 다음 사용자 이름을 지정합니다.
            - **Filter on run name**: 이름이 지정된 정규식과 일치하는 run만 포함합니다. 토글을 클릭하여 필터를 켠 다음 정규식을 지정합니다.

          자동화는 미래에 추가될 컬렉션을 포함하여 프로젝트 내의 모든 컬렉션에 적용됩니다.
    1. **Next step**을 클릭합니다.
1. [webhook](#create-a-webhook)을 소유한 팀을 선택합니다.
1. **Action type**을 **Webhooks**로 설정한 다음 사용할 [webhook](#create-a-webhook)을 선택합니다. 
1. webhook에 페이로드가 필요한 경우, 이를 작성하여 **Payload** 필드에 붙여넣습니다. webhook에 엑세스 토큰을 구성한 경우, `${ACCESS_TOKEN}` [payload variable](#payload-variables)을 통해 토큰에 엑세스할 수 있습니다. webhook에 secret을 구성한 경우, 이름 앞에 `$`를 붙여 페이로드에서 해당 secret에 엑세스할 수 있습니다. webhook의 요구 사항은 webhook 서비스에 의해 결정됩니다.
1. **Next step**을 클릭합니다.
1. 자동화의 이름을 입력합니다. 선택적으로 설명을 입력할 수 있습니다. **Create automation**을 클릭합니다.
</Tab>
</Tabs>

## View and manage automations
<Tabs>
<Tab header="Registry">
Registry의 **Automations** 탭에서 registry 자동화를 관리합니다.

- 자동화의 세부 정보를 보려면 이름을 클릭합니다.
- 자동화를 편집하려면 액션 `...` 메뉴를 클릭한 다음 **Edit automation**을 클릭합니다.
- 자동화를 삭제하려면 액션 `...` 메뉴를 클릭한 다음 **Delete automation**을 클릭합니다. 확인 절차가 필요합니다.
</Tab>
<Tab header="Project">
W&B 관리자는 프로젝트의 **Automations** 탭에서 프로젝트 자동화를 보고 관리할 수 있습니다.

- 자동화의 세부 정보를 보려면 이름을 클릭합니다.
- 자동화를 편집하려면 액션 `...` 메뉴를 클릭한 다음 **Edit automation**을 클릭합니다.
- 자동화를 삭제하려면 액션 `...` 메뉴를 클릭한 다음 **Delete automation**을 클릭합니다. 확인 절차가 필요합니다.
</Tab>
</Tabs>

## Payload reference
이 섹션을 사용하여 webhook의 페이로드를 구성하세요. webhook 및 페이로드 테스트에 대한 자세한 내용은 [Troubleshoot your webhook](#troubleshoot-your-webhook)을 참조하세요.

### Payload variables
이 섹션은 webhook의 페이로드를 구성하는 데 사용할 수 있는 변수들을 설명합니다.

| 변수 | 세부 정보 |
|----------|---------|
| `${project_name}`             | 액션을 트리거한 변경 사항을 소유한 프로젝트의 이름. |
| `${entity_name}`              | 액션을 트리거한 변경 사항을 소유한 Entity 또는 팀의 이름.
| `${event_type}`               | 액션을 트리거한 이벤트의 유형. |
| `${event_author}`             | 액션을 트리거한 사용자. |
| `${alias}`                    | 자동화가 **An artifact alias is added** 이벤트에 의해 트리거된 경우 아티팩트의 에일리어스를 포함합니다. 다른 자동화의 경우 이 변수는 비어 있습니다. |
| `${tag}`                      | 자동화가 **An artifact tag is added** 이벤트에 의해 트리거된 경우 아티팩트의 태그를 포함합니다. 다른 자동화의 경우 이 변수는 비어 있습니다. |
| `${artifact_collection_name}` | 아티팩트 버전이 링크된 아티팩트 컬렉션의 이름. |
| `${artifact_metadata.<KEY>}`  | 액션을 트리거한 아티팩트 버전의 임의의 최상위 메타데이터 키 값. `<KEY>`를 최상위 메타데이터 키의 이름으로 바꿉니다. webhook 페이로드에서는 최상위 메타데이터 키만 사용할 수 있습니다. |
| `${artifact_version}`         | 액션을 트리거한 아티팩트 버전의 [`Wandb.Artifact`](/models/ref/python/experiments/artifact.md/) 표현. |
| `${artifact_version_string}` | 액션을 트리거한 아티팩트 버전의 `string` 표현. |
| `${ACCESS_TOKEN}` | [webhook](#create-a-webhook)에 구성된 엑세스 토큰의 값 (구성된 경우). 엑세스 토큰은 `Authorization: Bearer` HTTP 헤더에 자동으로 전달됩니다. |
| `${SECRET_NAME}` | [webhook](#create-a-webhook)에 구성된 경우 해당 secret의 값. `SECRET_NAME`을 secret의 이름으로 바꿉니다. |

### Payload examples
이 섹션에는 몇 가지 일반적인 유스 케이스에 대한 webhook 페이로드 예시가 포함되어 있습니다. 예시는 [payload variables](#payload-variables) 사용 방법을 보여줍니다.

<Tabs>
<Tab header="GitHub repository dispatch">
<Note>
GHA 워크플로우를 트리거하는 데 필요한 권한 세트가 엑세스 토큰에 있는지 확인하세요. 자세한 내용은 [GitHub 문서](https://docs.github.com/en/rest/repos/repos?#create-a-repository-dispatch-event)를 참조하세요.
</Note>

W&B에서 GitHub 액션을 트리거하기 위해 repository dispatch를 보냅니다. 예를 들어, `on` 키에 대해 repository dispatch를 트리거로 허용하는 GitHub 워크플로우 파일이 있다고 가정해 보겠습니다.

```yaml
on:
repository_dispatch:
  types: BUILD_AND_DEPLOY
```

Repository를 위한 페이로드는 다음과 같을 수 있습니다:

```json
{
  "event_type": "BUILD_AND_DEPLOY",
  "client_payload": 
  {
    "event_author": "${event_author}",
    "artifact_version": "${artifact_version}",
    "artifact_version_string": "${artifact_version_string}",
    "artifact_collection_name": "${artifact_collection_name}",
    "project_name": "${project_name}",
    "entity_name": "${entity_name}"
    }
}
```

<Note>
webhook 페이로드의 `event_type` 키는 GitHub 워크플로우 YAML 파일의 `types` 필드와 일치해야 합니다.
</Note>

렌더링된 템플릿 문자열의 내용과 위치는 자동화가 구성된 이벤트 또는 모델 버전에 따라 달라집니다. `${event_type}`은 `LINK_ARTIFACT` 또는 `ADD_ARTIFACT_ALIAS` 중 하나로 렌더링됩니다. 아래의 매핑 예시를 참조하세요:

```text
${event_type} --> "LINK_ARTIFACT" 또는 "ADD_ARTIFACT_ALIAS"
${event_author} --> "<wandb-user>"
${artifact_version} --> "wandb-artifact://_id/QXJ0aWZhY3Q6NTE3ODg5ODg3""
${artifact_version_string} --> "<entity>/model-registry/<registered_model_name>:<alias>"
${artifact_collection_name} --> "<registered_model_name>"
${project_name} --> "model-registry"
${entity_name} --> "<entity>"
```

템플릿 문자열을 사용하여 W&B에서 GitHub Actions 및 기타 툴로 컨텍스트를 동적으로 전달할 수 있습니다. 해당 툴에서 Python 스크립트를 호출할 수 있는 경우, [W&B API](/models/artifacts/download-and-use-an-artifact/)를 통해 등록된 모델 아티팩트를 사용할 수 있습니다.

- Repository dispatch에 대한 자세한 정보는 [GitHub Marketplace의 공식 문서](https://github.com/marketplace/actions/repository-dispatch)를 참조하세요.

- 모델 평가 및 배포를 위한 자동화 생성 가이드인 [Webhook Automations for Model Evaluation](https://www.youtube.com/watch?v=7j-Mtbo-E74&ab_channel=Weights%26Biases) 및 [Webhook Automations for Model Deployment](https://www.youtube.com/watch?v=g5UiAFjM2nA&ab_channel=Weights%26Biases) 영상을 시청하세요. 

- 모델 CI를 위해 Github Actions webhook 자동화를 사용하는 방법을 설명하는 W&B [리포트](https://wandb.ai/wandb/wandb-model-cicd/reports/Model-CI-CD-with-W-B--Vmlldzo0OTcwNDQw)를 검토하세요. Modal Labs webhook으로 모델 CI를 생성하는 방법을 배우려면 이 [GitHub repository](https://github.com/hamelsmu/wandb-modal-webhook)를 확인하세요.
</Tab>
<Tab header="Microsoft Teams notification">
이 페이로드 예시는 webhook을 사용하여 Teams 채널에 알림을 보내는 방법을 보여줍니다:

```json 
{
"@type": "MessageCard",
"@context": "http://schema.org/extensions",
"summary": "New Notification",
"sections": [
  {
    "activityTitle": "Notification from WANDB",
    "text": "This is an example message sent via Teams webhook.",
    "facts": [
      {
        "name": "Author",
        "value": "${event_author}"
      },
      {
        "name": "Event Type",
        "value": "${event_type}"
      }
    ],
    "markdown": true
  }
]
}
```

실행 시점에 (위의 Teams 예시처럼) 템플릿 문자열을 사용하여 W&B 데이터를 페이로드에 삽입할 수 있습니다.
</Tab>
<Tab header="Slack notifications">
<Note>
이 섹션은 과거 기록을 위해 제공됩니다. 현재 Slack 연동을 위해 webhook을 사용 중이라면, 대신 [새로운 Slack 인테그레이션](#create-a-slack-automation)을 사용하도록 설정을 업데이트하는 것을 권장합니다.
</Note>

[Slack API 문서](https://api.slack.com/messaging/webhooks)에 안내된 지침에 따라 Slack 앱을 설정하고 수신 webhook 인테그레이션을 추가하세요. `Bot User OAuth Token` 아래에 지정된 secret이 W&B webhook의 엑세스 토큰으로 설정되어 있는지 확인하세요. 

다음은 페이로드 예시입니다:

```json
{
    "text": "New alert from WANDB!",
"blocks": [
    {
            "type": "section",
        "text": {
            "type": "mrkdwn",
            "text": "Registry event: ${event_type}"
        }
    },
        {
            "type":"section",
            "text": {
            "type": "mrkdwn",
            "text": "New version: ${artifact_version_string}"
        }
        },
        {
        "type": "divider"
    },
        {
            "type": "section",
        "text": {
            "type": "mrkdwn",
            "text": "Author: ${event_author}"
        }
        }
    ]
}
```
</Tab>
</Tabs>

## Troubleshoot your webhook
W&B 앱 UI를 통해 대화식으로, 또는 Bash 스크립트를 통해 프로그래밍 방식으로 webhook의 문제를 해결할 수 있습니다. 새로운 webhook을 생성하거나 기존 webhook을 편집할 때 문제를 해결할 수 있습니다.

W&B가 `POST` 요청에 사용하는 형식에 대한 자세한 내용은 **Bash 스크립트** 탭을 참조하세요.

<Tabs>
<Tab header="W&B App UI">
팀 관리자는 W&B 앱 UI에서 대화식으로 webhook을 테스트할 수 있습니다. 

1. W&B Team Settings 페이지로 이동합니다.
2. **Webhooks** 섹션으로 스크롤합니다.
3. webhook 이름 옆에 있는 가로 점 세 개(미트볼 아이콘)를 클릭합니다.
4. **Test**를 선택합니다.
5. 나타나는 UI 패널에서 나타나는 필드에 POST 요청을 붙여넣습니다. 
    <Frame>
    <img src="/images/models/webhook_ui.png" alt="webhook 페이로드 테스트 데모"  />
    </Frame>
6. **Test webhook**을 클릭합니다. W&B 앱 UI 내에서 W&B가 엔드포인트의 응답을 게시합니다.
    <Frame>
    <img src="/images/models/webhook_ui_testing.gif" alt="webhook 테스트 데모"  />
    </Frame>

데모는 [Testing Webhooks in W&B](https://www.youtube.com/watch?v=bl44fDpMGJw&ab_channel=Weights%26Biases) 영상을 시청하세요.
</Tab>
<Tab header="Bash script">
이 쉘 스크립트는 트리거 시 W&B가 webhook 자동화로 보내는 요청과 유사한 `POST` 요청을 생성하는 한 가지 방법을 보여줍니다.

webhook 문제를 해결하려면 아래 코드를 쉘 스크립트에 복사하여 붙여넣으세요. 다음 값들을 직접 지정하세요:

* `ACCESS_TOKEN`
* `SECRET`
* `PAYLOAD`
* `API_ENDPOINT`


```bash webhook_test.sh
#!/bin/bash

# 엑세스 토큰 및 secret
ACCESS_TOKEN="your_api_key"
SECRET="your_api_secret"

# 전송하려는 데이터 (예: JSON 형식)
PAYLOAD='{"key1": "value1", "key2": "value2"}'

# HMAC 서명 생성
# 보안을 위해, Wandb는 페이로드와 webhook에 연결된 
# 공유 비밀 키로부터 HMAC SHA-256 알고리즘을 사용하여 
# 계산된 X-Wandb-Signature를 헤더에 포함합니다.
SIGNATURE=$(echo -n "$PAYLOAD" | openssl dgst \
-sha256 -hmac "$SECRET" -binary | base64)

# cURL 요청 실행
curl -X POST \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  -H "X-Wandb-Signature: $SIGNATURE" \
  -d "$PAYLOAD" API_ENDPOINT
```
</Tab>
</Tabs>