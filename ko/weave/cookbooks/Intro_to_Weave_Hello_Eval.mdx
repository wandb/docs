---
title: Evaluations ë„ì…
description: thoughtful_thought W&B Weave ë¥¼ í™œìš©í•œ evaluation ë„ì…(introduction) ì‚¬ìš©ë²•ì— ëŒ€í•´
  ì•Œì•„ë³´ì„¸ìš”.
---

<Note>
ì´ê²ƒì€ ì¸í„°ë™í‹°ë¸Œ ë…¸íŠ¸ë¶ì…ë‹ˆë‹¤. ë¡œì»¬ì—ì„œ ì‹¤í–‰í•˜ê±°ë‚˜ ì•„ë˜ ë§í¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- [Google Colabì—ì„œ ì—´ê¸°](https://colab.research.google.com/github/wandb/docs/blob/main/weave/cookbooks/source/Intro_to_Weave_Hello_Eval.ipynb)
- [GitHubì—ì„œ ì†ŒìŠ¤ ë³´ê¸°](https://github.com/wandb/docs/blob/main/weave/cookbooks/source/Intro_to_Weave_Hello_Eval.ipynb)
</Note>

## ğŸ”‘ Prerequisites

Weave í‰ê°€ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— ë‹¤ìŒì˜ ì „ì œ ì¡°ê±´ì„ ì™„ë£Œí•˜ì„¸ìš”.

1. W&B Weave SDKë¥¼ ì„¤ì¹˜í•˜ê³  [API í‚¤](https://wandb.ai/settings#apikeys)ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.
2. OpenAI SDKë¥¼ ì„¤ì¹˜í•˜ê³  [API í‚¤](https://platform.openai.com/api-keys)ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.
3. W&B Projects ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.

```python lines
# ì˜ì¡´ì„± ì„¤ì¹˜ ë° ì„í¬íŠ¸
!pip install wandb weave openai -q

import os
from getpass import getpass

from openai import OpenAI
from pydantic import BaseModel

import weave

# ğŸ”‘ API í‚¤ ì„¤ì •
# ì´ ì…€ì„ ì‹¤í–‰í•˜ë©´ `getpass`ë¥¼ í†µí•´ API í‚¤ ì…ë ¥ì„ ìš”ì²­í•˜ë©°, í„°ë¯¸ë„ì—ëŠ” í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
#####
print("---")
print(
    "ë‹¤ìŒ ë§í¬ì—ì„œ W&B API í‚¤ë¥¼ ìƒì„±í•˜ì„¸ìš”: https://wandb.ai/settings#apikeys"
)
os.environ["WANDB_API_KEY"] = getpass("W&B API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ")
print("---")
print("ë‹¤ìŒ ë§í¬ì—ì„œ OpenAI API í‚¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: https://platform.openai.com/api-keys")
os.environ["OPENAI_API_KEY"] = getpass("OpenAI API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ")
print("---")
#####

# ğŸ  W&B í”„ë¡œì íŠ¸ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”
weave_client = weave.init("MY_PROJECT_NAME")  # ğŸ ì‚¬ìš©ìì˜ W&B í”„ë¡œì íŠ¸ ì´ë¦„
```

## ğŸ ì²« ë²ˆì§¸ í‰ê°€ ì‹¤í–‰í•˜ê¸°

ë‹¤ìŒ ì½”ë“œ ìƒ˜í”Œì€ Weave ì˜ `Model` ë° `Evaluation` APIë¥¼ ì‚¬ìš©í•˜ì—¬ LLMì„ í‰ê°€í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ë¨¼ì € `weave.Model`ì„ ìƒì†ë°›ì•„ Weave ëª¨ë¸ì„ ì •ì˜í•˜ê³ , ëª¨ë¸ ì´ë¦„ê³¼ í”„ë¡¬í”„íŠ¸ í˜•ì‹ì„ ì§€ì •í•œ ë’¤ `@weave.op`ë¥¼ ì‚¬ìš©í•˜ì—¬ `predict` ë©”ì†Œë“œë¥¼ ì¶”ì í•©ë‹ˆë‹¤. `predict` ë©”ì†Œë“œëŠ” OpenAIì— í”„ë¡¬í”„íŠ¸ë¥¼ ë³´ë‚´ê³  Pydantic ìŠ¤í‚¤ë§ˆ(`FruitExtract`)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ë‹µì„ êµ¬ì¡°í™”ëœ ì¶œë ¥ìœ¼ë¡œ íŒŒì‹±í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì…ë ¥ ë¬¸ì¥ê³¼ ì˜ˆìƒ íƒ€ê²Ÿìœ¼ë¡œ êµ¬ì„±ëœ ì‘ì€ í‰ê°€ ë°ì´í„°ì…‹ì„ ë§Œë“­ë‹ˆë‹¤. ë‹¤ìŒìœ¼ë¡œ, ëª¨ë¸ì˜ ì¶œë ¥ê³¼ íƒ€ê²Ÿ ë ˆì´ë¸”ì„ ë¹„êµí•˜ëŠ” ì»¤ìŠ¤í…€ ìŠ¤ì½”ì–´ë§ í•¨ìˆ˜(`@weave.op`ë¡œ ì¶”ì ë¨)ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ, ëª¨ë“  ê²ƒì„ `weave.Evaluation`ìœ¼ë¡œ ê°ì‹¸ ë°ì´í„°ì…‹ê³¼ ìŠ¤ì½”ì–´ëŸ¬ë¥¼ ì§€ì •í•˜ê³  `evaluate()`ë¥¼ í˜¸ì¶œí•˜ì—¬ í‰ê°€ íŒŒì´í”„ë¼ì¸ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.

```python lines
# 1. Weave ëª¨ë¸ êµ¬ì„±
class FruitExtract(BaseModel):
    fruit: str
    color: str
    flavor: str

class ExtractFruitsModel(weave.Model):
    model_name: str
    prompt_template: str

    @weave.op()
    def predict(self, sentence: str) -> dict:
        client = OpenAI()

        response = client.beta.chat.completions.parse(
            model=self.model_name,
            messages=[
                {
                    "role": "user",
                    "content": self.prompt_template.format(sentence=sentence),
                }
            ],
            response_format=FruitExtract,
        )
        result = response.choices[0].message.parsed
        return result

model = ExtractFruitsModel(
    name="gpt4o",
    model_name="gpt-4o",
    prompt_template='Extract fields ("fruit": <str>, "color": <str>, "flavor": <str>) as json, from the following text : {sentence}',
)

# 2. ìƒ˜í”Œ ìˆ˜ì§‘
sentences = [
    "There are many fruits that were found on the recently discovered planet Goocrux. There are neoskizzles that grow there, which are purple and taste like candy.",
    "Pounits are a bright green color and are more savory than sweet.",
    "Finally, there are fruits called glowls, which have a very sour and bitter taste which is acidic and caustic, and a pale orange tinge to them.",
]
labels = [
    {"fruit": "neoskizzles", "color": "purple", "flavor": "candy"},
    {"fruit": "pounits", "color": "green", "flavor": "savory"},
    {"fruit": "glowls", "color": "orange", "flavor": "sour, bitter"},
]
examples = [
    {"id": "0", "sentence": sentences[0], "target": labels[0]},
    {"id": "1", "sentence": sentences[1], "target": labels[1]},
    {"id": "2", "sentence": sentences[2], "target": labels[2]},
]

# 3. í‰ê°€ë¥¼ ìœ„í•œ ìŠ¤ì½”ì–´ë§ í•¨ìˆ˜ ì •ì˜
@weave.op()
def fruit_name_score(target: dict, output: FruitExtract) -> dict:
    target_flavors = [f.strip().lower() for f in target["flavor"].split(",")]
    output_flavors = [f.strip().lower() for f in output.flavor.split(",")]
    # íƒ€ê²Ÿ í’ë¯¸ê°€ ì¶œë ¥ í’ë¯¸ì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
    matches = any(tf in of for tf in target_flavors for of in output_flavors)
    return {"correct": matches}

# 4. í‰ê°€ ì‹¤í–‰
evaluation = weave.Evaluation(
    name="fruit_eval",
    dataset=examples,
    scorers=[fruit_name_score],
)
await evaluation.evaluate(model)
```

## ğŸš€ ë” ë§ì€ ì˜ˆì œë¥¼ ì°¾ìœ¼ì‹œë‚˜ìš”?

- [ì—”ë“œíˆ¬ì—”ë“œ í‰ê°€ íŒŒì´í”„ë¼ì¸ êµ¬ì¶• ë°©ë²•](/weave/tutorial-eval)ì„ ì•Œì•„ë³´ì„¸ìš”.
- [RAG ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶• ë° í‰ê°€ ë°©ë²•](/weave/tutorial-rag)ì„ ì•Œì•„ë³´ì„¸ìš”.