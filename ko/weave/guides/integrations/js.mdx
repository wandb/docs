---
title: "TypeScript SDK: 서드파티 통합 가이드"
description: "Weave TypeScript SDK와 서드파티 라이브러리를 통합하는 방법"
---

이 가이드는 서드파티(타사) 라이브러리(예: OpenAI)를 Weave TypeScript SDK와 통합하는 방법을 설명합니다. Weave는 자동 계측(automatic instrumentation)을 지원하므로 설정이 더 간단해지고, 수동 구성이 필요한 부분이 줄어듭니다.

<Warning>
**무엇이 바뀌었나요?**
[PR #4554](https://github.com/wandb/weave/pull/4554)부터 OpenAI와 같은 지원되는 라이브러리는 Weave가 로드될 때 자동으로 패치됩니다. 이전처럼 수동으로 감싸는 작업은 더 이상 필요하지 않습니다:

```ts lines
weave.wrapOpenAI(new OpenAI());
```

일반적으로 Weave가 이를 자동으로 처리합니다. 다만, [고급 사용법](#advanced-usage)에 설명된 것처럼 예외적인 상황이 있을 수 있습니다.
</Warning>

<div id="usage-instructions">
  ## 사용 방법
</div>

CommonJS 또는 ESM을 사용할 수 있습니다.

<div id="commonjs">
  ### CommonJS
</div>

CommonJS에서는 별도의 설정이 필요하지 않습니다. 자동 패칭이 기본으로 바로 동작합니다. Weave만 설치하면 됩니다:

```bash
npm install weave
```


<div id="esm">
  ### ESM
</div>

ESM 환경에서는 Node의 `--import` 플래그를 사용해 자동 계측(auto-instrumentation)을 활성화합니다. `weave` 패키지가 설치되어 있기만 하면 `weave/instrument` 모듈을 사용할 수 있습니다.

1. Weave를 설치합니다:
    ```bash
    npm install weave
    ```
2. `weave/instrument` 모듈을 가져옵니다:
    ```bash
    node --import=weave/instrument dist/main.js
    ```

<div id="advanced-usage-and-troubleshooting">
  ## 고급 사용법 및 문제 해결
</div>

이 섹션에서는 TypeScript SDK의 자동 패치가 예상대로 동작하지 않는 경우의 예외적인 상황과 우회 방법을 다룹니다. 예를 들어, ESM 전용 환경, Next.js 같은 번들러 설정, 또는 제약이 많은 런타임 환경에서는 예기치 않은 문제가 발생할 수 있습니다. 추적 데이터가 누락되거나 통합 관련 문제가 발생한다면, 여기서부터 확인하세요.

<div id="use-node_options-only-for-esm">
  ### `NODE_OPTIONS` 사용하기 (ESM 전용)
</div>

<Warning>
  `NODE_OPTIONS`를 사용할 때는 주의하세요. 이 설정은 환경의 모든 Node.js 프로세스에 영향을 주어 부작용을 일으킬 수 있습니다.
</Warning>

ESM 프로젝트를 사용 중이고 CLI 플래그를 전달할 수 없다면(예: CLI 도구나 프레임워크의 제약 때문), `NODE_OPTIONS` 환경 변수를 설정하세요:

```bash
export NODE_OPTIONS="--import=weave/instrument"
```


<div id="bundler-compatibility">
  ### 번들러 호환성
</div>

Next.js 같은 일부 프레임워크와 번들러는 서드파티 라이브러리를 번들링하는 방식 때문에 Node가 런타임에 라이브러리를 패치하지 못하게 만들 수 있습니다.

설정이 이와 비슷하다면, 다음 단계를 시도해 보세요:

1. 번들러 설정에서 LLM 라이브러리를 external로 지정하세요. 이렇게 하면 이 라이브러리들이 번들링되지 않아서 Weave가 런타임에 올바르게 패치할 수 있습니다.

   다음 예시는 `next.config.js` 설정에서 `openai` 패키지를 external로 지정하는 방법을 보여 줍니다. 이렇게 하면 해당 패키지가 번들링되지 않습니다. 이 모듈은 런타임에 로드되므로 Weave가 자동으로 패치하고 추적할 수 있습니다. Next.js 같은 프레임워크를 사용할 때 자동 계측을 활성화하려면 이 구성을 사용하세요.

    ```js
    externals: {
    'openai': 'commonjs openai'
    }
    ```

2. 그래도 패치에 실패한다면, [수동 계측](#manual-patching-fallback-option)을 대신 사용하세요.

<div id="manual-patching-fallback-option">
  ### 수동 패치(대체 옵션)
</div>

<Warning>
  수동 패치는 기존(레거시) 방식으로, 자동 패치가 동작하지 않을 때에만 사용해야 합니다.
</Warning>

일부 상황에서는 여전히 수동 계측을 사용해야 할 수 있습니다:

```ts lines
import { wrapOpenAI } from 'weave';
const client = wrapOpenAI(new OpenAI());
```
