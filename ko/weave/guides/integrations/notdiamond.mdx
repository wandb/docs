---
title: "Not Diamond ¬◇"
description: "Not Diamond을 사용하면 정확도를 최대화하고 비용을 절감하면서, 요구 사항에 맞는 적절한 모델로 프롬프트를 라우팅할 수 있습니다"
---

복잡한 LLM 워크플로를 구축할 때 사용자는 정확도, 비용 또는 호출 지연 시간에 따라 서로 다른 모델에 프롬프트를 보내야 할 수 있습니다. 사용자는 이러한 워크플로에서 [Not Diamond][nd]를 사용하여 프롬프트를 자신의 요구 사항에 맞는 적절한 모델로 라우팅할 수 있으며, 이를 통해 정확도를 최대화하면서 모델 비용을 절감할 수 있습니다.

<div id="getting-started">
  ## 시작하기
</div>

먼저 [계정을 생성][account]하고 [API 키를 발급][keys]한 다음, 발급받은 API 키를 `NOTDIAMOND_API_KEY`라는 이름으로 환경 변수에 추가하세요.

![Create an API key](/weave/guides/integrations/imgs/notdiamond/api-keys.png)

이후 예를 들어 다음과 같은 작업을 할 수 있습니다.

- [퀵스타트 가이드][quickstart guide]를 따라 해 보거나
- W&B Weave와 Not Diamond를 사용해 [커스텀 라우터][custom router]를 만들거나
- [Not Diamond와 채팅][chat]하면서 라우팅이 실제로 어떻게 동작하는지 확인할 수 있습니다

<div id="tracing">
  ## 트레이싱
</div>

Weave는 [Not Diamond의 Python 라이브러리][python]와 통합되어 [API 호출을 자동으로 로깅합니다][ops].
워크플로우 시작 시 `weave.init()`만 실행한 후, 평소처럼 라우팅된
프로바이더를 계속 사용하면 됩니다:

```python lines
from notdiamond import NotDiamond

import weave
weave.init('notdiamond-quickstart')

client = NotDiamond()
session_id, provider = client.chat.completions.model_select(
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Concisely explain merge sort."}
    ],
    model=['openai/gpt-4o', 'anthropic/claude-3-5-sonnet-20240620']
)

print("LLM called: ", provider.provider)  # openai, anthropic 등
print("Provider model: ", provider.model) # gpt-4o, claude-3-5-sonnet-20240620 등
```


<div id="custom-routing">
  ## 커스텀 라우팅
</div>

[Evaluations][evals]에서 [커스텀 라우터]를 직접 트레이닝하여 Not Diamond가 평가 성능에 따라 특화된 사용 사례별로 프롬프트를 라우팅하도록 할 수 있습니다.

먼저 커스텀 라우터를 트레이닝하세요:

```python lines
from weave.flow.eval import EvaluationResults
from weave.integrations.notdiamond.custom_router import train_router

# gpt-4o와 Claude 3.5 Sonnet에 대한 Evaluation 빌드
evaluation = weave.Evaluation(...)
gpt_4o = weave.Model(...)
sonnet = weave.Model(...)

model_evals = {
    'openai/gpt-4o': evaluation.get_eval_results(gpt_4o),
    'anthropic/claude-3-5-sonnet-20240620': evaluation.get_eval_results(sonnet),
}
preference_id = train_router(
    model_evals=model_evals,
    prompt_column="prompt",
    response_column="actual",
    language="en",
    maximize=True,
)
```

이 preference ID를 모든 `model_select` 요청에서 재사용하면, 평가 데이터에 대해 성능을 극대화하고 비용을 최소화하도록 프롬프트를 전달할 수 있습니다:

```python lines
from notdiamond import NotDiamond
client = NotDiamond()

import weave
weave.init('notdiamond-quickstart')

session_id, provider = client.chat.completions.model_select(
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Concisely explain merge sort."}
    ],
    model=['openai/gpt-4o', 'anthropic/claude-3-5-sonnet-20240620'],

    # 이 preference ID를 전달하면 커스텀 라우터를 재사용합니다
    preference_id=preference_id
)

print("LLM called: ", provider.provider)  # openai, anthropic 등
print("Provider model: ", provider.model) # gpt-4o, claude-3-5-sonnet-20240620 등
```


<div id="additional-support">
  ## 추가 지원
</div>

추가 지원이 필요하면 [docs]를 방문하거나 [문의 메일을 보내세요][support].

[account]: https://app.notdiamond.ai

[chat]: https://chat.notdiamond.ai

[custom router]: https://docs.notdiamond.ai/docs/router-training-quickstart

[docs]: https://docs.notdiamond.ai

[evals]: /weave/guides/core-types/evaluations

[keys]: https://app.notdiamond.ai/keys

[nd]: https://www.notdiamond.ai/

[ops]: /weave/guides/tracking/ops

[python]: https://github.com/Not-Diamond/notdiamond-python

[quickstart guide]: https://docs.notdiamond.ai/docs/quickstart-routing

[support]: mailto:support@notdiamond.ai