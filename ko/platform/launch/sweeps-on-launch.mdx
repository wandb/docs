---
title: W&B Launch를 사용하여 Sweeps 생성하기
description: Launch 에서 하이퍼파라미터 Sweeps 를 자동화하는 방법을 알아보세요.
---

<Card title="Colab에서 시도하기" href="https://colab.research.google.com/drive/1WxLKaJlltThgZyhc7dcZhDQ6cjVQDfil#scrollTo=AFEzIxA6foC7" icon="python"/>

W&B Launch를 사용하여 하이퍼파라미터 튜닝 작업 ([Sweeps](/models/sweeps/))을 생성하세요. Launch에서의 Sweeps를 사용하면, 탐색할 하이퍼파라미터가 지정된 Sweep 스케줄러가 Launch Queue에 푸시됩니다. 에이전트가 Sweep 스케줄러를 가져와 시작하면, 선택된 하이퍼파라미터로 해당 큐에 Sweep Runs를 실행합니다. 이 과정은 Sweep이 완료되거나 중단될 때까지 계속됩니다.

기본 W&B Sweep 스케줄링 엔진을 사용하거나 사용자 정의 스케줄러를 직접 구현할 수 있습니다.

1. 표준 Sweep 스케줄러: [W&B Sweeps](/models/sweeps/)를 제어하는 기본 W&B Sweep 스케줄링 엔진을 사용합니다. 익숙한 `bayes`, `grid`, `random` 메소드를 사용할 수 있습니다.
2. 커스텀 Sweep 스케줄러: Sweep 스케줄러를 하나의 작업(job)으로 실행되도록 설정합니다. 이 옵션은 완전한 커스터마이징을 가능하게 합니다. 더 많은 로깅을 포함하도록 표준 Sweep 스케줄러를 확장하는 예시는 아래 섹션에서 확인할 수 있습니다.

<Note>
이 가이드는 W&B Launch가 이전에 구성되었다고 가정합니다. W&B Launch가 구성되지 않은 경우, Launch 문서의 [시작 방법](./#how-to-get-started) 섹션을 참조하세요.
</Note>

<Note>
Launch에서의 Sweeps를 처음 사용하는 경우 'basic' 메소드를 사용하여 생성을 시작하는 것을 권장합니다. 표준 W&B 스케줄링 엔진이 요구 사항을 충족하지 못할 때 커스텀 스케줄러를 사용하세요.
</Note>

## W&B 표준 스케줄러로 Sweep 생성하기
Launch를 사용하여 W&B Sweeps를 생성하세요. W&B App에서 대화형으로 생성하거나 W&B CLI를 사용하여 프로그래밍 방식으로 생성할 수 있습니다. 스케줄러 커스터마이징을 포함한 고급 Launch Sweeps 설정의 경우 CLI를 사용하세요.

<Note>
W&B Launch로 Sweep을 생성하기 전에, 먼저 Sweep을 수행할 작업을 생성해야 합니다. 자세한 내용은 [작업 생성하기](/platform/launch/create-launch-job/) 페이지를 참조하세요.
</Note>

<Tabs>
<Tab title="W&B app">
W&B App을 통해 대화형으로 Sweep을 생성합니다.

1. W&B App에서 해당 W&B Project로 이동합니다.
2. 왼쪽 패널에서 Sweeps 아이콘(빗자루 이미지)을 선택합니다.
3. 다음으로, **Create Sweep** 버튼을 선택합니다.
4. **Configure Launch** 버튼을 클릭합니다.
5. **Job** 드롭다운 메뉴에서 Sweep을 생성할 원본 작업의 이름과 버전을 선택합니다.
6. **Queue** 드롭다운 메뉴를 사용하여 Sweep을 실행할 큐를 선택합니다.
7. **Job Priority** 드롭다운을 사용하여 Launch 작업의 우선순위를 지정합니다. Launch Queue가 우선순위를 지원하지 않는 경우 "Medium"으로 설정됩니다.
8. (선택 사항) Run 또는 Sweep 스케줄러에 대한 오버라이드 인수를 설정합니다. 예를 들어, 스케줄러 오버라이드를 사용하여 `num_workers`로 스케줄러가 관리하는 동시 실행 수를 설정할 수 있습니다.
9. (선택 사항) **Destination Project** 드롭다운 메뉴를 사용하여 Sweep을 저장할 프로젝트를 선택합니다.
10. **Save**를 클릭합니다.
11. **Launch Sweep**을 선택합니다.

<Frame>
    <img src="/images/launch/create_sweep_with_launch.png" alt="Launch sweep configuration"  />
</Frame>
</Tab>
<Tab title="CLI">
W&B CLI를 사용하여 프로그래밍 방식으로 Launch 기반 W&B Sweep을 생성합니다.

1. Sweep 설정을 생성합니다.
2. Sweep 설정 내에 전체 작업(job) 이름을 지정합니다.
3. Sweep 에이전트를 초기화합니다.

<Note>
1단계와 3단계는 일반적인 W&B Sweep을 생성할 때와 동일합니다.
</Note>

예를 들어, 아래 코드 조각에서는 작업 값으로 `'wandb/jobs/Hello World 2:latest'`를 지정합니다.

```yaml
# launch-sweep-config.yaml

job: 'wandb/jobs/Hello World 2:latest'
description: sweep examples using launch jobs

method: bayes
metric:
  goal: minimize
  name: loss_metric
parameters:
  learning_rate:
    max: 0.02
    min: 0
    distribution: uniform
  epochs:
    max: 20
    min: 0
    distribution: int_uniform

# 선택 사항 스케줄러 파라미터:

# scheduler:
#   num_workers: 1  # 동시 실행 sweep runs 수
#   docker_image: <스케줄러의 베이스 이미지>
#   resource: <예: local-container...>
#   resource_args:  # runs에 전달될 리소스 인수
#     env: 
#         - WANDB_API_KEY

# 선택 사항 Launch 파라미터
# launch: 
#    registry: <이미지 풀링을 위한 레지스트리>
```

Sweep 설정 생성 방법에 대한 자세한 내용은 [Sweep 설정 정의하기](/platform/launch/sweeps-on-launch/) 페이지를 참조하세요.

4. 다음으로 Sweep을 초기화합니다. 설정 파일 경로, 작업 큐 이름, W&B Entity 및 프로젝트 이름을 입력합니다.

```bash
wandb launch-sweep <path/to/yaml/file> --queue <queue_name> --entity <your_entity>  --project <project_name>
```

W&B Sweeps에 대한 자세한 정보는 [하이퍼파라미터 튜닝](/models/sweeps/) 챕터를 참조하세요.
</Tab>
</Tabs>

## 커스텀 Sweep 스케줄러 생성하기
W&B 스케줄러 또는 커스텀 스케줄러를 사용하여 커스텀 Sweep 스케줄러를 생성하세요.

<Note>
스케줄러 작업을 사용하려면 wandb cli 버전 `0.15.4` 이상이 필요합니다.
</Note>

<Tabs>
<Tab title="W&B scheduler">
W&B Sweep 스케줄링 로직을 작업으로 사용하여 Launch Sweep을 생성합니다.
  
  1. 공개 `wandb/sweep-jobs` 프로젝트에서 Wandb 스케줄러 작업을 식별하거나, 다음 작업 이름을 사용합니다:
  `'wandb/sweep-jobs/job-wandb-sweep-scheduler:latest'`
  2. 이 이름을 가리키는 `job` 키를 포함한 `scheduler` 블록을 추가하여 설정 yaml 파일을 구성합니다 (아래 예시 참조).
  3. 새 설정과 함께 `wandb launch-sweep` 명령을 사용합니다.

설정 예시:
```yaml
# launch-sweep-config.yaml  
description: Launch sweep config using a scheduler job
scheduler:
  job: wandb/sweep-jobs/job-wandb-sweep-scheduler:latest
  num_workers: 8  # 8개의 동시 sweep runs 허용

# sweep runs가 실행할 트레이닝/튜닝 작업
job: wandb/sweep-jobs/job-fashion-MNIST-train:latest
method: grid
parameters:
  learning_rate:
    min: 0.0001
    max: 0.1
```
</Tab>
<Tab title="Custom scheduler">
스케줄러 작업을 생성하여 커스텀 스케줄러를 만들 수 있습니다. 이 가이드에서는 로깅을 강화하기 위해 `WandbScheduler`를 수정하는 방법을 다룹니다.

  1. `wandb/launch-jobs` 레포지토리를 클론합니다 (특히: `wandb/launch-jobs/jobs/sweep_schedulers`).
  2. 이제 원하는 로깅 증가를 위해 `wandb_scheduler.py`를 수정할 수 있습니다. 예: 새로운 Sweep Runs를 시작하기 전, 매 폴링 주기(설정 가능한 타이밍)마다 호출되는 `_poll` 함수에 로깅을 추가합니다.
  3. 수정된 파일을 실행하여 작업을 생성합니다: `python wandb_scheduler.py --project <project> --entity <entity> --name CustomWandbScheduler`
  4. 생성된 작업의 이름을 UI 또는 이전 호출의 출력에서 확인합니다. 이는 별도로 지정하지 않는 한 code-artifact 작업이 됩니다.
  5. 이제 스케줄러가 새 작업을 가리키도록 Sweep 설정을 생성합니다.

```yaml
...
scheduler:
  job: '<entity>/<project>/job-CustomWandbScheduler:latest'
...
```
</Tab>
<Tab title="Optuna scheduler">
Optuna는 다양한 알고리즘을 사용하여 주어진 모델에 최적의 하이퍼파라미터를 찾는 하이퍼파라미터 최적화 프레임워크입니다 (W&B와 유사). [샘플링 알고리즘](https://optuna.readthedocs.io/en/stable/reference/samplers/index.html) 외에도 Optuna는 성능이 낮은 실행을 조기에 종료할 수 있는 다양한 [가지치기(pruning) 알고리즘](https://optuna.readthedocs.io/en/stable/reference/pruners.html)을 제공합니다. 이는 대규모 실행을 할 때 시간과 리소스를 절약할 수 있어 특히 유용합니다. 클래스는 고도로 설정 가능하며, 설정 파일의 `scheduler.settings.pruner/sampler.args` 블록에 필요한 파라미터를 전달하기만 하면 됩니다.

Optuna의 스케줄링 로직을 작업으로 사용하여 Launch Sweep을 생성합니다.

1. 먼저 직접 작업을 생성하거나 미리 빌드된 Optuna 스케줄러 이미지 작업을 사용합니다.
    * 직접 작업을 생성하는 방법은 [`wandb/launch-jobs`](https://github.com/wandb/launch-jobs/blob/main/jobs/sweep_schedulers) 레포지토리 예시를 참조하세요.
    * 미리 빌드된 Optuna 이미지를 사용하려면 `wandb/sweep-jobs` 프로젝트의 `job-optuna-sweep-scheduler`로 이동하거나 작업 이름 `wandb/sweep-jobs/job-optuna-sweep-scheduler:latest`를 사용할 수 있습니다.

2. 작업을 생성한 후 Sweep을 생성할 수 있습니다. Optuna 스케줄러 작업을 가리키는 `job` 키가 포함된 `scheduler` 블록을 포함하여 Sweep 설정을 구성합니다 (아래 예시 참조).

```yaml
  # optuna_config_basic.yaml
  description: A basic Optuna scheduler
  job: wandb/sweep-jobs/job-fashion-MNIST-train:latest
  run_cap: 5
  metric:
    name: epoch/val_loss
    goal: minimize

  scheduler:
    job: wandb/sweep-jobs/job-optuna-sweep-scheduler:latest
    resource: local-container  # 이미지 기반 스케줄러 작업에 필수
    num_workers: 2

    # optuna 관련 설정
    settings:
      pruner:
        type: PercentilePruner
        args:
          percentile: 25.0  # 75%의 실행을 종료
          n_warmup_steps: 10  # 처음 x 단계 동안은 가지치기 비활성화

  parameters:
    learning_rate:
      min: 0.0001
      max: 0.1
  ```

3. 마지막으로 launch-sweep 명령을 사용하여 활성 큐에 Sweep을 실행합니다.
  
  ```bash
  wandb launch-sweep <config.yaml> -q <queue> -p <project> -e <entity>
  ```

  Optuna Sweep 스케줄러 작업의 정확한 구현은 [wandb/launch-jobs](https://github.com/wandb/launch-jobs/blob/main/jobs/sweep_schedulers/optuna_scheduler/optuna_scheduler.py)를 참조하세요. Optuna 스케줄러로 가능한 더 많은 예시는 [wandb/examples](https://github.com/wandb/examples/tree/master/examples/launch/launch-sweeps/optuna-scheduler)에서 확인할 수 있습니다.
</Tab>
</Tabs>

커스텀 Sweep 스케줄러 작업으로 가능한 예시들은 [wandb/launch-jobs](https://github.com/wandb/launch-jobs) 레포지토리의 `jobs/sweep_schedulers` 아래에서 확인할 수 있습니다. 이 가이드는 공개적으로 사용 가능한 **Wandb Scheduler Job**을 사용하는 방법과 커스텀 Sweep 스케줄러 작업을 만드는 프로세스를 보여줍니다.

## Launch에서의 Sweep 재개 방법
이전에 실행된 Launch Sweep에서 작업을 재개하는 것도 가능합니다. 하이퍼파라미터와 트레이닝 작업은 변경할 수 없지만, 스케줄러 관련 파라미터와 푸시되는 큐는 변경할 수 있습니다.

<Note>
초기 Sweep이 'latest'와 같은 에일리어스가 지정된 트레이닝 작업을 사용한 경우, 마지막 실행 이후 최신 작업 버전이 변경되었다면 재개 시 결과가 달라질 수 있습니다.
</Note>

1. 이전에 실행된 Launch Sweep의 이름/ID를 확인합니다. Sweep ID는 W&B App의 프로젝트에서 찾을 수 있는 8자리 문자열(예: `hhd16935`)입니다.
2. 스케줄러 파라미터를 변경하는 경우 업데이트된 설정 파일을 작성합니다.
3. 터미널에서 다음 명령을 실행합니다. `< >`로 감싸진 내용을 해당 정보로 교체하세요:

```bash
wandb launch-sweep <optional config.yaml> --resume_id <sweep id> --queue <queue_name>
```