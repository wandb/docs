---
description: Launch에서 하이퍼파라미터 스윕을 자동화하는 방법을 알아보세요.
title: W&B Launch로 스윕 생성하기
---

<Card title="Colab에서 실행해 보기" href="https://colab.research.google.com/drive/1WxLKaJlltThgZyhc7dcZhDQ6cjVQDfil#scrollTo=AFEzIxA6foC7" icon="python" />

W&amp;B Launch로 하이퍼파라미터 튜닝 작업([스윕](/ko/models/sweeps/))을 생성합니다. Launch에서 스윕을 사용하면, 지정한 하이퍼파라미터에 대해 스윕 스케줄러가 Launch Queue로 전송됩니다. 에이전트가 이를 가져가면 스윕 스케줄러가 시작되며, 선택된 하이퍼파라미터로 동일한 큐에 스윕 실행들을 실행시킵니다. 이는 스윕이 완료되거나 중지될 때까지 계속됩니다.

기본 W&amp;B Sweep 스케줄링 엔진을 사용하거나 직접 사용자 정의 스케줄러를 구현할 수 있습니다:

1. 표준 스윕 스케줄러: [W&amp;B Sweeps](/ko/models/sweeps/)를 제어하는 기본 W&amp;B Sweep 스케줄링 엔진을 사용합니다. 익숙한 `bayes`, `grid`, `random` 메서드를 사용할 수 있습니다.
2. 사용자 정의 스윕 스케줄러: 스윕 스케줄러가 작업으로 실행되도록 구성합니다. 이 옵션을 사용하면 완전한 커스터마이징이 가능합니다. 표준 스윕 스케줄러를 확장하여 더 많은 로깅을 포함시키는 예시는 아래 섹션에서 확인할 수 있습니다.

<Note>
  이 가이드는 W&amp;B Launch가 미리 설정되어 있다고 가정합니다. W&amp;B Launch가 아직 설정되지 않았다면, Launch 문서의 [시작 방법](./#how-to-get-started) 섹션을 참조하세요.
</Note>

<Note>
  Launch에서 스윕을 처음 사용하는 사용자라면, &#39;basic&#39; 메서드를 사용하여 Launch에서 스윕을 생성하는 것을 권장합니다. 표준 W&amp;B 스케줄링 엔진으로는 요구사항을 충족할 수 없을 때 Launch용 사용자 정의 스윕 스케줄러를 사용하세요.
</Note>

<div id="create-a-sweep-with-a-wb-standard-scheduler">
  ## W&amp;B 표준 스케줄러로 Sweep 생성하기
</div>

Launch를 사용해 W&amp;B Sweep을 생성할 수 있습니다. W&amp;B App에서 대화형으로 Sweep을 만들거나 W&amp;B CLI를 사용해 프로그래밍 방식으로 만들 수 있습니다. 스케줄러 커스터마이징을 포함한 Launch Sweep의 고급 구성을 사용하려면 CLI를 사용하십시오.

<Note>
  W&amp;B Launch로 Sweep을 생성하기 전에 먼저 Sweep 대상이 될 Job을 생성해야 합니다. 자세한 내용은 [Create a Job](/ko/platform/launch/create-launch-job/) 페이지를 참조하십시오.
</Note>

<Tabs>
  <Tab title="W&B 앱">
    W&amp;B App에서 대화형으로 Sweep을 생성합니다.

    1. W&amp;B App에서 자신의 W&amp;B 프로젝트로 이동합니다.
    2. 왼쪽 패널에서 Sweeps 아이콘(빗자루 이미지)을 선택합니다.
    3. **Create Sweep** 버튼을 선택합니다.
    4. **Configure Launch** 버튼을 클릭합니다.
    5. **Job** 드롭다운 메뉴에서 Sweep을 생성할 Job 이름과 Job 버전을 선택합니다.
    6. **Queue** 드롭다운 메뉴를 사용해 Sweep을 실행할 큐를 선택합니다.
    7. **Job Priority** 드롭다운을 사용해 Launch Job의 우선순위를 지정합니다. Launch 큐가 우선순위를 지원하지 않는 경우 Launch Job의 우선순위는 &quot;Medium&quot;으로 설정됩니다.
    8. (선택 사항) 실행 또는 Sweep 스케줄러에 대한 override args를 구성합니다. 예를 들어 스케줄러 override를 사용해 `num_workers`로 스케줄러가 관리하는 동시 실행 개수를 설정할 수 있습니다.
    9. (선택 사항) **Destination Project** 드롭다운 메뉴를 사용해 Sweep을 저장할 프로젝트를 선택합니다.
    10. **Save**를 클릭합니다.
    11. **Launch Sweep**을 선택합니다.

    <Frame>
      <img src="/images/launch/create_sweep_with_launch.png" alt="Launch Sweep 구성" />
    </Frame>
  </Tab>

  <Tab title="CLI">
    W&amp;B CLI를 사용해 Launch로 W&amp;B Sweep을 프로그래밍 방식으로 생성합니다.

    1. Sweep 구성을 생성합니다.
    2. Sweep 구성에 전체 Job 이름을 지정합니다.
    3. Sweep agent를 초기화합니다.

    <Note>
      1번과 3번 단계는 일반적으로 W&amp;B Sweep을 생성할 때 수행하는 단계와 동일합니다.
    </Note>

    예를 들어, 다음 코드 스니펫에서는 job 값으로 `'wandb/jobs/Hello World 2:latest'`를 지정합니다:

    ```yaml
    # launch-sweep-config.yaml

    job: 'wandb/jobs/Hello World 2:latest'
    description: launch job을 사용하는 sweep 예제

    method: bayes
    metric:
      goal: minimize
      name: loss_metric
    parameters:
      learning_rate:
        max: 0.02
        min: 0
        distribution: uniform
      epochs:
        max: 20
        min: 0
        distribution: int_uniform

    # 선택적 스케줄러 매개변수:

    # scheduler:
    #   num_workers: 1  # 동시 sweep 실행 개수
    #   docker_image: <스케줄러에 사용할 기본 이미지>
    #   resource: <예: local-container...>
    #   resource_args:  # 실행에 전달되는 resource 인자
    #     env: 
    #         - WANDB_API_KEY

    # 선택적 Launch 매개변수
    # launch: 
    #    registry: <이미지 pull에 사용할 레지스트리>
    ```

    Sweep 구성을 생성하는 방법에 대한 자세한 내용은 [Define sweep configuration](/ko/platform/launch/sweeps-on-launch/) 페이지를 참조하십시오.

    4. 다음으로 Sweep을 초기화합니다. 구성 파일 경로, Job 큐 이름, W&amp;B 엔터티, 프로젝트 이름을 지정합니다.

    ```bash
    wandb launch-sweep <path/to/yaml/file> --queue <queue_name> --entity <your_entity>  --project <project_name>
    ```

    W&amp;B Sweep에 대한 자세한 내용은 [Tune Hyperparameters](/ko/models/sweeps/) 챕터를 참조하십시오.
  </Tab>
</Tabs>

<div id="create-a-custom-sweep-scheduler">
  ## 사용자 지정 스윕 스케줄러 만들기
</div>

W&amp;B 스케줄러 또는 사용자 지정 스케줄러를 사용해 사용자 지정 스윕 스케줄러를 만드세요.

<Note>
  스케줄러 작업을 사용하려면 wandb CLI 버전이 `0.15.4` 이상이어야 합니다.
</Note>

<Tabs>
  <Tab title="W&B 스케줄러">
    W&amp;B sweep 스케줄링 로직을 job으로 사용하여 launch sweep을 생성합니다.

    1. 공개 프로젝트인 wandb/sweep-jobs에서 W&amp;B scheduler job을 찾거나, 다음 job 이름을 사용합니다:
       `'wandb/sweep-jobs/job-wandb-sweep-scheduler:latest'`
    2. 아래 예시와 같이 이 이름을 가리키는 `job` 키를 포함한 `scheduler` 블록을 추가하여 configuration YAML을 작성합니다.
    3. 새 config와 함께 `wandb launch-sweep` 명령을 사용합니다.

    예시 config:

    ```yaml
    # launch-sweep-config.yaml  
    description: 스케줄러 작업을 사용하는 Launch sweep 구성
    scheduler:
      job: wandb/sweep-jobs/job-wandb-sweep-scheduler:latest
      num_workers: 8  # 동시 sweep 실행 8개 허용

    # sweep 실행이 수행할 학습/튜닝 작업
    job: wandb/sweep-jobs/job-fashion-MNIST-train:latest
    method: grid
    parameters:
      learning_rate:
        min: 0.0001
        max: 0.1
    ```
  </Tab>

  <Tab title="사용자 지정 스케줄러">
    사용자 정의 스케줄러는 scheduler-job을 생성해서 만들 수 있습니다. 이 가이드에서는 더 많은 로깅을 제공하기 위해 `WandbScheduler`를 수정합니다.

    1. `wandb/launch-jobs` 리포지토리를 클론합니다 (특히: `wandb/launch-jobs/jobs/sweep_schedulers`).
    2. 이제 `wandb_scheduler.py`를 수정하여 원하는 수준의 로깅을 구현할 수 있습니다. 예: `_poll` 함수에 로깅을 추가합니다. 이 함수는 새로운 sweep 실행을 시작하기 전에, 각 폴링 사이클(구성 가능한 주기)마다 한 번씩 호출됩니다.
    3. 수정한 파일을 다음과 같이 실행하여 job을 생성합니다: `python wandb_scheduler.py --project <project> --entity <entity> --name CustomWandbScheduler`
    4. 생성된 job의 이름을 UI에서 확인하거나, 이전 호출의 출력에서 확인합니다. 이 job은 (별도로 명시하지 않는 한) code-artifact job입니다.
    5. 이제 스케줄러가 새 job을 가리키도록 sweep 구성을 생성합니다.

    ```yaml
    ...
    scheduler:
      job: '<entity>/<project>/job-CustomWandbScheduler:latest'
    ...
    ```
  </Tab>

  <Tab title="Optuna 스케줄러">
    Optuna는 주어진 모델에 대해 최적의 하이퍼파라미터를 찾기 위해 다양한 알고리즘을 사용하는 하이퍼파라미터 최적화 프레임워크입니다(W&amp;B와 유사). [샘플링 알고리즘](https://optuna.readthedocs.io/en/stable/reference/samplers/index.html)에 더해, Optuna는 성능이 낮은 실행을 조기에 종료하는 데 사용할 수 있는 다양한 [프루닝 알고리즘](https://optuna.readthedocs.io/en/stable/reference/pruners.html)도 제공합니다. 이는 많은 수의 실행을 수행할 때 시간과 리소스를 절약할 수 있어 특히 유용합니다. 해당 클래스들은 매우 유연하게 설정할 수 있으며, 설정 파일의 `scheduler.settings.pruner/sampler.args` 블록에 필요한 파라미터를 전달하기만 하면 됩니다.

    Job을 사용하여 Optuna의 스케줄링 로직을 적용한 Launch 스윕을 생성합니다.

    1. 먼저, 직접 job을 만들거나 미리 빌드된 Optuna 스케줄러 이미지 job을 사용합니다.
       * 자체 job을 만드는 예시는 [`wandb/launch-jobs`](https://github.com/wandb/launch-jobs/blob/main/jobs/sweep_schedulers) 리포지토리를 참고하세요.
       * 미리 빌드된 Optuna 이미지를 사용하려면 `wandb/sweep-jobs` 프로젝트에서 `job-optuna-sweep-scheduler`로 이동하거나, job 이름 `wandb/sweep-jobs/job-optuna-sweep-scheduler:latest`를 사용할 수 있습니다.

    2. job을 생성한 후에는 스윕을 만들 수 있습니다. Optuna 스케줄러 job을 가리키는 `job` 키가 포함된 `scheduler` 블록을 스윕 설정에 구성합니다(아래 예시 참조).

    ```yaml
      # optuna_config_basic.yaml
      description: 기본 Optuna 스케줄러
      job: wandb/sweep-jobs/job-fashion-MNIST-train:latest
      run_cap: 5
      metric:
        name: epoch/val_loss
        goal: minimize

      scheduler:
        job: wandb/sweep-jobs/job-optuna-sweep-scheduler:latest
        resource: local-container  # 이미지에서 가져온 스케줄러 작업에 필요
        num_workers: 2

        # optuna 전용 설정
        settings:
          pruner:
            type: PercentilePruner
            args:
              percentile: 25.0  # 실행의 75% 중단
              n_warmup_steps: 10  # 처음 x 스텝 동안 pruning 비활성화

      parameters:
        learning_rate:
          min: 0.0001
          max: 0.1
    ```

    3. 마지막으로 `launch-sweep` 명령으로 sweep을 활성 큐에 제출합니다:

    ```bash
    wandb launch-sweep <config.yaml> -q <queue> -p <project> -e <entity>
    ```

    Optuna 스윕 스케줄러 작업의 정확한 구현은 [wandb/launch-jobs](https://github.com/wandb/launch-jobs/blob/main/jobs/sweep_schedulers/optuna_scheduler/optuna_scheduler.py)에서 확인하세요. Optuna 스케줄러로 할 수 있는 작업의 추가 예시는 [wandb/examples](https://github.com/wandb/examples/tree/master/examples/launch/launch-sweeps/optuna-scheduler)를 참고하세요.
  </Tab>
</Tabs>

사용자 정의 sweep 스케줄러 job으로 할 수 있는 작업 예시는 [wandb/launch-jobs](https://github.com/wandb/launch-jobs) 저장소의 `jobs/sweep_schedulers` 디렉터리에서 확인할 수 있습니다. 이 가이드에서는 공개적으로 제공되는 **Wandb Scheduler Job**을 사용하는 방법과, 사용자 정의 sweep 스케줄러 job을 만드는 절차를 함께 다룹니다.

<div id="how-to-resume-sweeps-on-launch">
  ## Launch에서 스위프를 재개하는 방법
</div>

이전에 실행한 스위프에서 Launch 스위프를 다시 시작할 수도 있습니다. 하이퍼파라미터와 학습 작업은 변경할 수 없지만, 스케줄러별 파라미터와 스위프가 전송되는 큐는 변경할 수 있습니다.

<Note>
  초기 스위프에서 &#39;latest&#39;와 같은 별칭이 있는 학습 작업을 사용한 경우, 마지막 실행 이후 최신 작업 버전이 변경되었다면 재개 시 다른 결과가 나올 수 있습니다.
</Note>

1. 이전에 실행된 Launch 스위프의 스위프 이름/ID를 확인합니다. 스위프 ID는 `hhd16935`와 같은 8자 길이의 문자열이며, W&amp;B App의 프로젝트에서 찾을 수 있습니다.
2. 스케줄러 파라미터를 변경하는 경우, 변경된 설정 파일을 작성합니다.
3. 터미널에서 다음 명령을 실행합니다. `<` 및 `>`로 둘러싸인 내용을 본인의 정보로 바꾸십시오:

```bash
wandb launch-sweep <optional config.yaml> --resume_id <sweep id> --queue <queue_name>
```
