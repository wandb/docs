---
description: Launch에서 하이퍼파라미터 스윕을 자동화하는 방법을 알아보세요.
title: W&B Launch로 스윕 생성하기
---

<Card title="Colab에서 실행해 보기" href="https://colab.research.google.com/drive/1WxLKaJlltThgZyhc7dcZhDQ6cjVQDfil#scrollTo=AFEzIxA6foC7" icon="python" />

W&amp;B Launch로 하이퍼파라미터 튜닝 작업([sweeps](/ko/models/sweeps/))을 생성합니다. Launch에서 스윕을 사용하면, 지정한 하이퍼파라미터에 대해 스윕을 수행하는 스윕 스케줄러가 Launch Queue로 전송됩니다. 에이전트가 스케줄러를 가져오면 스윕 스케줄러가 시작되고, 선택된 하이퍼파라미터로 스윕 run을 동일한 큐에서 실행합니다. 이는 스윕이 완료되거나 중지될 때까지 계속됩니다.

기본 W&amp;B Sweep 스케줄링 엔진을 사용하거나, 사용자 지정 스케줄러를 구현할 수 있습니다:

1. 표준 스윕 스케줄러: [W&amp;B Sweeps](/ko/models/sweeps/)를 제어하는 기본 W&amp;B Sweep 스케줄링 엔진을 사용합니다. 익숙한 `bayes`, `grid`, `random` 메서드를 사용할 수 있습니다.
2. 커스텀 스윕 스케줄러: 스윕 스케줄러가 잡으로 실행되도록 구성합니다. 이 옵션은 완전한 커스터마이징을 가능하게 합니다. 표준 스윕 스케줄러를 확장해 더 많은 로깅을 포함하는 방법의 예시는 아래 섹션에서 확인할 수 있습니다.

<Note>
  이 가이드는 W&amp;B Launch가 미리 구성되어 있다고 가정합니다. W&amp;B Launch가 아직 구성되지 않았다면, Launch 문서의 [시작하기](./#how-to-get-started) 섹션을 참고하세요.
</Note>

<Note>
  Launch에서 스윕을 처음 사용하는 사용자라면 &#39;basic&#39; 메서드를 사용해 Launch에서 스윕을 생성할 것을 권장합니다. 기본 W&amp;B 스케줄링 엔진으로 요구 사항을 충족할 수 없을 때는 커스텀 Launch 스윕 스케줄러를 사용하세요.
</Note>

<div id="create-a-sweep-with-a-wb-standard-scheduler">
  ## W&amp;B 표준 스케줄러로 스윕 생성하기
</div>

Launch를 사용해 W&amp;B Sweeps를 생성할 수 있습니다. W&amp;B App에서 상호작용 방식으로 스윕을 생성하거나 W&amp;B CLI로 프로그래밍 방식으로 생성할 수 있습니다. 스케줄러 커스터마이징 기능을 포함한 고급 Launch 스윕 설정을 하려면 CLI를 사용하세요.

<Note>
  W&amp;B Launch로 스윕을 생성하기 전에, 먼저 스윕을 수행할 job을 생성했는지 확인하세요. 자세한 내용은 [Create a Job](/ko/platform/launch/create-launch-job/) 페이지를 참고하세요.
</Note>

<Tabs>
  <Tab title="W&B 앱">
    W&amp;B App에서 상호작용 방식으로 스윕을 생성합니다.

    1. W&amp;B App에서 자신의 W&amp;B 프로젝트로 이동합니다.
    2. 프로젝트 사이드바에서 스윕 아이콘(빗자루 이미지)을 선택합니다.
    3. 다음으로 **Create Sweep** 버튼을 선택합니다.
    4. **Configure Launch** 버튼을 클릭합니다.
    5. **Job** 드롭다운 메뉴에서 스윕을 생성할 job 이름과 job 버전을 선택합니다.
    6. **Queue** 드롭다운 메뉴를 사용해 스윕을 실행할 queue를 선택합니다.
    7. **Job Priority** 드롭다운을 사용해 launch job의 우선순위를 지정합니다. launch queue가 우선순위를 지원하지 않는 경우, launch job의 우선순위는 &quot;Medium&quot;으로 설정됩니다.
    8. (선택) run 또는 스윕 스케줄러에 대해 override 인자를 설정합니다. 예를 들어, 스케줄러 override를 사용해 `num_workers`로 스케줄러가 관리하는 동시 run 개수를 설정할 수 있습니다.
    9. (선택) **Destination Project** 드롭다운 메뉴를 사용해 스윕을 저장할 프로젝트를 선택합니다.
    10. **Save**를 클릭합니다.
    11. **Launch Sweep**을 선택합니다.

    <Frame>
      <img src="/images/launch/create_sweep_with_launch.png" alt="Launch 스윕 설정" />
    </Frame>
  </Tab>

  <Tab title="CLI">
    W&amp;B CLI를 사용해 Launch로 W&amp;B Sweep을 프로그래밍 방식으로 생성합니다.

    1. 스윕 설정을 생성합니다.
    2. 스윕 설정 안에 전체 job 이름을 지정합니다.
    3. 스윕 에이전트를 초기화합니다.

    <Note>
      1단계와 3단계는 일반적으로 W&amp;B Sweep을 생성할 때 수행하는 단계와 동일합니다.
    </Note>

    예를 들어, 다음 코드 스니펫에서는 job 값으로 `'wandb/jobs/Hello World 2:latest'`를 지정합니다:

    ```yaml
    # launch-sweep-config.yaml

    job: 'wandb/jobs/Hello World 2:latest'
    description: launch job을 사용하는 스윕 예시

    method: bayes
    metric:
      goal: minimize
      name: loss_metric
    parameters:
      learning_rate:
        max: 0.02
        min: 0
        distribution: uniform
      epochs:
        max: 20
        min: 0
        distribution: int_uniform

    # 선택적 스케줄러 파라미터:

    # scheduler:
    #   num_workers: 1  # 동시 스윕 run 수
    #   docker_image: <스케줄러용 베이스 이미지>
    #   resource: <예: local-container...>
    #   resource_args:  # run에 전달되는 resource 인자
    #     env: 
    #         - WANDB_API_KEY

    # 선택적 Launch 파라미터
    # launch: 
    #    registry: <이미지 풀링용 레지스트리>
    ```

    스윕 설정을 생성하는 방법은 [Define sweep configuration](/ko/platform/launch/sweeps-on-launch/) 페이지를 참고하세요.

    4. 다음으로 스윕을 초기화합니다. 설정 파일 경로, job queue 이름, W&amp;B entity, 그리고 프로젝트 이름을 지정합니다.

    ```bash
    wandb launch-sweep <path/to/yaml/file> --queue <queue_name> --entity <your_entity>  --project <project_name>
    ```

    W&amp;B Sweeps에 대한 자세한 내용은 [Tune Hyperparameters](/ko/models/sweeps/) 챕터를 참고하세요.
  </Tab>
</Tabs>

<div id="create-a-custom-sweep-scheduler">
  ## 커스텀 스윕 스케줄러 생성
</div>

W&amp;B 스케줄러 또는 커스텀 스케줄러를 사용하여 커스텀 스윕 스케줄러를 생성합니다.

<Note>
  스케줄러 작업을 사용하려면 wandb CLI 버전이 `0.15.4` 이상이어야 합니다.
</Note>

<Tabs>
  <Tab title="W&B 스케줄러">
    W&amp;B 스윕 스케줄링 로직을 job으로 사용해 Launch 스윕을 생성합니다.

    1. 공개 `wandb/sweep-jobs` 프로젝트에서 wandb 스케줄러 job을 찾거나, 다음 job 이름을 사용합니다:
       `'wandb/sweep-jobs/job-wandb-sweep-scheduler:latest'`
    2. 아래 예시처럼, 이 이름을 가리키는 `job` 키를 포함한 추가 `scheduler` 블록이 들어 있는 설정 YAML을 작성합니다.
    3. 새 설정과 함께 `wandb launch-sweep` 명령을 사용합니다.

    설정 예시:

    ```yaml
    # launch-sweep-config.yaml  
    description: 스케줄러 job을 사용하는 Launch 스윕 설정
    scheduler:
      job: wandb/sweep-jobs/job-wandb-sweep-scheduler:latest
      num_workers: 8  # 동시 스윕 run 8개 허용

    # 스윕 run이 실행할 트레이닝/튜닝 job
    job: wandb/sweep-jobs/job-fashion-MNIST-train:latest
    method: grid
    parameters:
      learning_rate:
        min: 0.0001
        max: 0.1
    ```
  </Tab>

  <Tab title="사용자 정의 스케줄러">
    사용자 지정 스케줄러는 scheduler-job을 생성하여 만들 수 있습니다. 이 가이드에서는 더 많은 로깅을 제공하기 위해 `WandbScheduler`를 수정해 보겠습니다.

    1. `wandb/launch-jobs` 리포지토리를 클론합니다(특히: `wandb/launch-jobs/jobs/sweep_schedulers`).
    2. 이제 `wandb_scheduler.py`를 수정하여 원하는 수준으로 로깅을 늘릴 수 있습니다. 예: `_poll` 함수에 로깅을 추가합니다. 이 함수는 새 스윕 run을 시작하기 전에, 각 폴링 주기마다(설정 가능한 주기) 한 번씩 호출됩니다.
    3. 수정한 파일을 실행하여 job을 생성합니다: `python wandb_scheduler.py --project <project> --entity <entity> --name CustomWandbScheduler`
    4. 생성된 job의 이름을 UI에서 확인하거나, 이전 호출의 출력에서 확인합니다. 이 job은(별도로 지정하지 않았다면) code 아티팩트 job입니다.
    5. 이제 스케줄러가 새 job을 가리키도록 스윕 설정을 생성합니다.

    ```yaml
    ...
    scheduler:
      job: '<entity>/<project>/job-CustomWandbScheduler:latest'
    ...
    ```
  </Tab>

  <Tab title="Optuna 스케줄러">
    Optuna는 주어진 모델에 대해 최적의 하이퍼파라미터를 찾기 위해 다양한 알고리즘을 사용하는 하이퍼파라미터 최적화 프레임워크입니다(W&amp;B와 유사). [샘플링 알고리즘](https://optuna.readthedocs.io/en/stable/reference/samplers/index.html)에 더해, Optuna는 성능이 좋지 않은 실행을 조기에 종료하는 데 사용할 수 있는 다양한 [pruning 알고리즘](https://optuna.readthedocs.io/en/stable/reference/pruners.html)도 제공합니다. 이는 많은 수의 실행을 돌릴 때 특히 유용하며, 시간과 리소스를 절약할 수 있습니다. 이 클래스들은 설정이 매우 유연하므로, 설정 파일의 `scheduler.settings.pruner/sampler.args` 블록에 필요한 파라미터만 전달하면 됩니다.

    job을 사용해 Optuna의 스케줄링 로직으로 Launch 스윕을 생성합니다.

    1. 먼저, 직접 job을 만들거나 미리 빌드된 Optuna scheduler 이미지 job을 사용합니다.
       * 직접 job을 만드는 방법에 대한 예시는 [`wandb/launch-jobs`](https://github.com/wandb/launch-jobs/blob/main/jobs/sweep_schedulers) 리포를 참고하세요.
       * 미리 빌드된 Optuna 이미지를 사용하려면 `wandb/sweep-jobs` 프로젝트에서 `job-optuna-sweep-scheduler`로 이동하거나, job 이름 `wandb/sweep-jobs/job-optuna-sweep-scheduler:latest`를 사용할 수 있습니다.

    2. job을 만든 후에는 스윕을 생성할 수 있습니다. Optuna scheduler job을 가리키는 `job` 키가 포함된 `scheduler` 블록을 스윕 설정에 구성합니다(아래 예시 참조).

    ```yaml
      # optuna_config_basic.yaml
      description: 기본 Optuna 스케줄러
      job: wandb/sweep-jobs/job-fashion-MNIST-train:latest
      run_cap: 5
      metric:
        name: epoch/val_loss
        goal: minimize

      scheduler:
        job: wandb/sweep-jobs/job-optuna-sweep-scheduler:latest
        resource: local-container  # 이미지에서 가져온 스케줄러 작업에 필요
        num_workers: 2

        # optuna 전용 설정
        settings:
          pruner:
            type: PercentilePruner
            args:
              percentile: 25.0  # run의 75%를 중단
              n_warmup_steps: 10  # 처음 x 스텝 동안 pruning 비활성화

      parameters:
        learning_rate:
          min: 0.0001
          max: 0.1
    ```

    3. 마지막으로 launch-sweep 명령을 실행해 스윕을 활성 큐로 보냅니다:

    ```bash
    wandb launch-sweep <config.yaml> -q <queue> -p <project> -e <entity>
    ```

    Optuna 스윕 스케줄러 잡의 정확한 구현은 [wandb/launch-jobs](https://github.com/wandb/launch-jobs/blob/main/jobs/sweep_schedulers/optuna_scheduler/optuna_scheduler.py)를 참고하세요. Optuna 스케줄러로 할 수 있는 작업의 더 많은 예시는 [wandb/examples](https://github.com/wandb/examples/tree/master/examples/launch/launch-sweeps/optuna-scheduler)에서 확인하세요.
  </Tab>
</Tabs>

커스텀 스윕 스케줄러 잡으로 할 수 있는 예시는 [wandb/launch-jobs](https://github.com/wandb/launch-jobs) 리포지토리의 `jobs/sweep_schedulers` 경로에서 확인할 수 있습니다. 이 가이드는 공개되어 있는 **Wandb Scheduler Job**을 사용하는 방법과 커스텀 스윕 스케줄러 잡을 생성하는 절차를 함께 보여줍니다.

<div id="how-to-resume-sweeps-on-launch">
  ## Launch에서 스윕을 재개하는 방법
</div>

이전에 실행한 스윕에서 Launch 스윕을 재개할 수도 있습니다. 하이퍼파라미터와 트레이닝 잡은 변경할 수 없지만, 스케줄러별 파라미터와 스윕이 전송되는 큐는 변경할 수 있습니다.

<Note>
  초기 스윕에서 &#39;latest&#39;와 같은 별칭이 있는 트레이닝 잡을 사용한 경우, 마지막 run 이후 최신 잡 버전이 변경되었다면 재개 시 다른 결과가 나올 수 있습니다.
</Note>

1. 이전에 실행된 Launch 스윕의 스윕 이름/ID를 확인합니다. 스윕 ID는 `hhd16935`와 같은 8자리 문자열이며, W&amp;B App의 프로젝트에서 확인할 수 있습니다.
2. 스케줄러 파라미터를 변경했다면, 업데이트된 설정 파일을 생성합니다.
3. 터미널에서 다음 명령을 실행합니다. `<`와 `>`로 감싸진 내용을 사용자 정보로 교체합니다:

```bash
wandb launch-sweep <optional config.yaml> --resume_id <sweep id> --queue <queue_name>
```
