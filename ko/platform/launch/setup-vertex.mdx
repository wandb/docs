---
title: '튜토리얼: Vertex AI에서 W&B Launch 설정하기'
---

W&amp;B Launch를 사용하여 Vertex AI 트레이닝 작업으로 실행할 작업을 제출할 수 있습니다. Vertex AI 트레이닝 작업을 사용하면 Vertex AI 플랫폼에서 제공된 알고리즘이나 커스텀 알고리즘을 사용해 머신 러닝 모델을 트레이닝할 수 있습니다. Launch 작업이 시작되면 Vertex AI가 기본 인프라, 스케일링, 오케스트레이션을 관리합니다.

W&amp;B Launch는 `google-cloud-aiplatform` SDK의 `CustomJob` 클래스를 통해 Vertex AI와 연동됩니다. `CustomJob`의 파라미터는 Launch 큐 설정으로 제어할 수 있습니다. Vertex AI는 Google Cloud 외부의 프라이빗 레지스트리에서 이미지를 가져오도록 설정할 수 없습니다. 이는 Vertex AI를 W&amp;B Launch와 함께 사용하려면 컨테이너 이미지를 Google Cloud 또는 퍼블릭 레지스트리에 저장해야 함을 의미합니다. Vertex AI 작업에서 컨테이너 이미지를 사용할 수 있도록 만드는 방법에 대해서는 Vertex AI 문서를 참조하세요.

{/* Vertex AI에서 Launch 구성도 */}


<div id="prerequisites">
  ## 사전 준비 사항
</div>

1. **Vertex AI API가 활성화된 Google Cloud 프로젝트를 생성하거나 해당 프로젝트에 액세스합니다.** API 활성화에 대한 자세한 내용은 [Google Cloud API Console 문서](https://support.google.com/googleapi/answer/6158841?hl=en)를 참조하세요.
2. **Google Cloud Artifact Registry 리포지토리를 생성**하여 Vertex에서 실행할 이미지를 저장합니다. 자세한 내용은 [Google Cloud Artifact Registry 문서](https://cloud.google.com/artifact-registry/docs/overview)를 참조하세요.
3. **Vertex AI 메타데이터를 저장할 스테이징용 GCS 버킷을 생성**합니다. 이 버킷은 스테이징 버킷으로 사용되려면 Vertex AI 워크로드와 동일한 리전에 있어야 합니다. 동일한 버킷을 스테이징과 빌드 컨텍스트 모두에 사용할 수 있습니다.
4. **Vertex AI 작업을 실행할 수 있는 필요한 권한을 가진 서비스 계정을 생성**합니다. 서비스 계정에 권한을 부여하는 방법에 대한 자세한 내용은 [Google Cloud IAM 문서](https://cloud.google.com/iam/docs/creating-managing-service-accounts)를 참조하세요.
5. **서비스 계정에 Vertex 작업을 관리할 수 있는 권한을 부여합니다.**

| Permission                     | Resource Scope              | Description                                                                                      |
| ------------------------------ | --------------------------- | ------------------------------------------------------------------------------------------------ |
| `aiplatform.customJobs.create` | 지정된 Google Cloud 프로젝트 | 프로젝트 내에서 새로운 머신 러닝 작업을 생성할 수 있습니다.                                      |
| `aiplatform.customJobs.list`   | 지정된 Google Cloud 프로젝트 | 프로젝트 내의 머신 러닝 작업 목록을 조회할 수 있습니다.                                          |
| `aiplatform.customJobs.get`    | 지정된 Google Cloud 프로젝트 | 프로젝트 내 특정 머신 러닝 작업에 대한 정보를 조회할 수 있습니다.                               |

<Note>
Vertex AI 워크로드가 기본이 아닌 서비스 계정의 ID를 사용하도록 하려면, 서비스 계정 생성 및 필요한 권한에 대한 지침은 Vertex AI 문서를 참조하세요. W&B run에 대해 커스텀 서비스 계정을 선택하려면 Launch 큐 설정의 `spec.service_account` 필드를 사용할 수 있습니다.
</Note>

<div id="configure-a-queue-for-vertex-ai">
  ## Vertex AI용 대기열 설정
</div>

Vertex AI 리소스에 대한 대기열 설정은 Vertex AI Python SDK에서 `CustomJob` 생성자와 `CustomJob`의 `run` 메서드에 전달되는 입력을 지정합니다. 리소스 설정은 `spec` 및 `run` 키 아래에 저장됩니다:

- `spec` 키에는 Vertex AI Python SDK의 [`CustomJob` 생성자](https://cloud.google.com/vertex-ai/docs/pipelines/customjob-component)에 전달되는 이름 있는 인자 값이 포함됩니다.
- `run` 키에는 Vertex AI Python SDK의 `CustomJob` 클래스에 있는 `run` 메서드에 전달되는 이름 있는 인자 값이 포함됩니다.

실행 환경의 맞춤 구성은 주로 `spec.worker_pool_specs` 목록에서 이루어집니다. 워커 풀 사양은 작업을 실행할 워커 그룹을 정의합니다. 기본 설정의 워커 사양은 가속기 없이 단일 `n1-standard-4` 머신을 요청합니다. 필요에 따라 머신 유형, 가속기 유형 및 개수를 변경할 수 있습니다.

사용 가능한 머신 유형 및 가속기 유형에 대한 자세한 내용은 [Vertex AI 문서](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/MachineSpec)를 참조하세요.

<div id="create-a-queue">
  ## 큐 생성
</div>

W&amp;B App에서 Vertex AI를 컴퓨트 리소스로 사용하는 큐를 생성합니다:

1. [Launch 페이지](https://wandb.ai/launch)로 이동합니다.
2. **Create Queue** 버튼을 클릭합니다.
3. 큐를 생성할 **Entity**를 선택합니다.
4. **Name** 필드에 큐 이름을 입력합니다.
5. **Resource**로 **Google Cloud Vertex AI**를 선택합니다.
6. **Configuration** 필드에 이전 섹션에서 정의한 Vertex AI `CustomJob`에 대한 정보를 입력합니다. 기본적으로 W&amp;B는 다음과 유사한 YAML 및 JSON 요청 본문을 미리 채워 둡니다:

```yaml
spec:
  worker_pool_specs:
    - machine_spec:
        machine_type: n1-standard-4
        accelerator_type: ACCELERATOR_TYPE_UNSPECIFIED
        accelerator_count: 0
      replica_count: 1
      container_spec:
        image_uri: ${image_uri}
  staging_bucket: <REQUIRED>
run:
  restart_job_on_worker_restart: false
```

7. 큐를 설정한 후 **Create Queue** 버튼을 클릭합니다.

다음 항목을 최소한 지정해야 합니다:

* `spec.worker_pool_specs` : 비어 있지 않은 worker 풀 사양 리스트.
* `spec.staging_bucket` : Vertex AI 자산과 메타데이터를 스테이징하는 데 사용할 GCS 버킷.

<Warning>
  일부 Vertex AI 문서에서는 예를 들어 `workerPoolSpecs`처럼 모든 키를 카멜 케이스로 표기한 worker 풀 사양을 보여줍니다. Vertex AI Python SDK는 이 키들에 대해 예를 들어 `worker_pool_specs`처럼 스네이크 케이스를 사용합니다.

  Launch 큐 설정의 모든 키는 스네이크 케이스를 사용해야 합니다.
</Warning>


<div id="configure-a-launch-agent">
  ## Launch 에이전트 구성
</div>

Launch 에이전트는 기본적으로 `~/.config/wandb/launch-config.yaml`에 위치한 구성 파일을 통해 설정할 수 있습니다.

```yaml
max_jobs: <n-concurrent-jobs>
queues:
  - <queue-name>
```

Launch 에이전트가 Vertex AI에서 실행할 이미지를 대신 빌드하도록 설정하려면 [고급 에이전트 설정](./setup-agent-advanced)을 참고하세요.


<div id="set-up-agent-permissions">
  ## 에이전트 권한 설정
</div>

이 서비스 계정으로 인증하는 방법은 여러 가지가 있습니다. Workload Identity, 다운로드한 서비스 계정 JSON 파일, 환경 변수, Google Cloud Platform 명령줄 도구, 또는 이러한 방법들을 조합해 사용할 수 있습니다.